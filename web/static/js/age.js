var age=(()=>{var Bn=Object.defineProperty;var Gs=Object.getOwnPropertyDescriptor;var zs=Object.getOwnPropertyNames;var Xs=Object.prototype.hasOwnProperty;var An=(e,t)=>{for(var n in t)Bn(e,n,{get:t[n],enumerable:!0})},Fs=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of zs(t))!Xs.call(e,o)&&o!==n&&Bn(e,o,{get:()=>t[o],enumerable:!(r=Gs(t,o))||r.enumerable});return e};var $s=e=>Fs(Bn({},"__esModule",{value:!0}),e);var Gc={};An(Gc,{Decrypter:()=>Mr,Encrypter:()=>Nr,Stanza:()=>dt,armor:()=>Ur,generateHybridIdentity:()=>Is,generateIdentity:()=>Ts,generateX25519Identity:()=>Tr,identityToRecipient:()=>ks,webauthn:()=>Hr});function te(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function X(e,t=""){if(!Number.isSafeInteger(e)||e<0){let n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function D(e,t,n=""){let r=te(e),o=e?.length,s=t!==void 0;if(!r||s&&o!==t){let i=n&&`"${n}" `,c=s?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(i+"expected Uint8Array"+c+", got "+f)}return e}function ut(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");X(e.outputLen),X(e.blockLen)}function Et(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ke(e,t){D(e,void 0,"digestInto() output");let n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function It(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function nt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function ee(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yt(e,t){return e<<32-t|e>>>t}function Z(e,t){return e<<t|e>>>32-t>>>0}var Ws=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ys(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Qs(e){for(let t=0;t<e.length;t++)e[t]=Ys(e[t]);return e}var ne=Ws?e=>e:Qs,jr=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Js=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Dt(e){if(D(e),jr)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=Js[e[n]];return t}var mt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Vr(e){if(e>=mt._0&&e<=mt._9)return e-mt._0;if(e>=mt.A&&e<=mt.F)return e-(mt.A-10);if(e>=mt.a&&e<=mt.f)return e-(mt.a-10)}function Pt(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(jr)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=Vr(e.charCodeAt(s)),c=Vr(e.charCodeAt(s+1));if(i===void 0||c===void 0){let f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[o]=i*16+c}return r}function ti(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Sn(e,t=""){return typeof e=="string"?ti(e):D(e,void 0,t)}function Y(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];D(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}function Ce(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}function re(e,t={}){let n=(o,s)=>e(s).update(o).digest(),r=e(void 0);return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=o=>e(o),Object.assign(n,t),Object.freeze(n)}function Q(e=32){let t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}var kt=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});var He=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(ut(t),D(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),nt(o)}update(t){return Et(this),this.iHash.update(t),this}digestInto(t){Et(this),D(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},gt=(e,t,n)=>new He(e,t).update(n).digest();gt.create=(e,t)=>new He(e,t);function Bt(e,t,n){return ut(e),n===void 0&&(n=new Uint8Array(e.outputLen)),gt(e,n,t)}var vn=Uint8Array.of(0),Zr=Uint8Array.of();function de(e,t,n,r=32){ut(e),X(r,"length");let o=e.outputLen;if(r>255*o)throw new Error("Length must be <= 255*HashLen");let s=Math.ceil(r/o);n===void 0?n=Zr:D(n,void 0,"info");let i=new Uint8Array(s*o),c=gt.create(e,t),f=c._cloneInto(),l=new Uint8Array(c.outputLen);for(let a=0;a<s;a++)vn[0]=a+1,f.update(a===0?Zr:l).update(n).update(vn).digestInto(l),i.set(l,o*a),c._cloneInto(f);return c.destroy(),f.destroy(),nt(l,vn),i.slice(0,r)}var Ut=(e,t,n,r,o)=>de(e,Bt(e,t,n),r,o);function Gr(e,t,n){return e&t^~e&n}function zr(e,t,n){return e&t^e&n^t&n}var he=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,n,r,o){this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=ee(this.buffer)}update(t){Et(this),D(t);let{view:n,buffer:r,blockLen:o}=this,s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let f=ee(t);for(;o<=s-i;i+=o)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Et(this),Ke(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,nt(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(r,0),i=0);for(let u=i;u<o;u++)n[u]=0;r.setBigUint64(o-8,BigInt(this.length*8),s),this.process(r,0);let c=ee(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen must be aligned to 32bit");let l=f/4,a=this.get();if(l>a.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)c.setUint32(4*u,a[u],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||=new this.constructor,t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=c,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}},At=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var st=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);var Ne=BigInt(4294967295),Xr=BigInt(32);function ei(e,t=!1){return t?{h:Number(e&Ne),l:Number(e>>Xr&Ne)}:{h:Number(e>>Xr&Ne)|0,l:Number(e&Ne)|0}}function Me(e,t=!1){let n=e.length,r=new Uint32Array(n),o=new Uint32Array(n);for(let s=0;s<n;s++){let{h:i,l:c}=ei(e[s],t);[r[s],o[s]]=[i,c]}return[r,o]}var Ln=(e,t,n)=>e>>>n,_n=(e,t,n)=>e<<32-n|t>>>n,qt=(e,t,n)=>e>>>n|t<<32-n,Vt=(e,t,n)=>e<<32-n|t>>>n,pe=(e,t,n)=>e<<64-n|t>>>n-32,ye=(e,t,n)=>e>>>n-32|t<<64-n;var Fr=(e,t,n)=>e<<n|t>>>32-n,$r=(e,t,n)=>t<<n|e>>>32-n,Wr=(e,t,n)=>t<<n-32|e>>>64-n,Yr=(e,t,n)=>e<<n-32|t>>>64-n;function xt(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Qr=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Jr=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,to=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),eo=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,no=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),ro=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;var ri=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Rt=new Uint32Array(64),Tn=class extends he{constructor(t){super(64,t,8,!1)}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:f}=this;return[t,n,r,o,s,i,c,f]}set(t,n,r,o,s,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let u=0;u<16;u++,n+=4)Rt[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){let d=Rt[u-15],h=Rt[u-2],x=yt(d,7)^yt(d,18)^d>>>3,b=yt(h,17)^yt(h,19)^h>>>10;Rt[u]=b+Rt[u-7]+x+Rt[u-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:f,G:l,H:a}=this;for(let u=0;u<64;u++){let d=yt(c,6)^yt(c,11)^yt(c,25),h=a+d+Gr(c,f,l)+ri[u]+Rt[u]|0,b=(yt(r,2)^yt(r,13)^yt(r,22))+zr(r,o,s)|0;a=l,l=f,f=c,c=i+h|0,i=s,s=o,o=r,r=h+b|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,l=l+this.G|0,a=a+this.H|0,this.set(r,o,s,i,c,f,l,a)}roundClean(){nt(Rt)}destroy(){this.set(0,0,0,0,0,0,0,0),nt(this.buffer)}},In=class extends Tn{A=At[0]|0;B=At[1]|0;C=At[2]|0;D=At[3]|0;E=At[4]|0;F=At[5]|0;G=At[6]|0;H=At[7]|0;constructor(){super(32)}};var oo=Me(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),oi=oo[0],si=oo[1],Ot=new Uint32Array(80),Kt=new Uint32Array(80),kn=class extends he{constructor(t){super(128,t,16,!1)}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:f,Eh:l,El:a,Fh:u,Fl:d,Gh:h,Gl:x,Hh:b,Hl:g}=this;return[t,n,r,o,s,i,c,f,l,a,u,d,h,x,b,g]}set(t,n,r,o,s,i,c,f,l,a,u,d,h,x,b,g){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=f|0,this.Eh=l|0,this.El=a|0,this.Fh=u|0,this.Fl=d|0,this.Gh=h|0,this.Gl=x|0,this.Hh=b|0,this.Hl=g|0}process(t,n){for(let B=0;B<16;B++,n+=4)Ot[B]=t.getUint32(n),Kt[B]=t.getUint32(n+=4);for(let B=16;B<80;B++){let k=Ot[B-15]|0,M=Kt[B-15]|0,O=qt(k,M,1)^qt(k,M,8)^Ln(k,M,7),P=Vt(k,M,1)^Vt(k,M,8)^_n(k,M,7),H=Ot[B-2]|0,v=Kt[B-2]|0,N=qt(H,v,19)^pe(H,v,61)^Ln(H,v,6),K=Vt(H,v,19)^ye(H,v,61)^_n(H,v,6),U=to(P,K,Kt[B-7],Kt[B-16]),w=eo(U,O,N,Ot[B-7],Ot[B-16]);Ot[B]=w|0,Kt[B]=U|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:f,Dh:l,Dl:a,Eh:u,El:d,Fh:h,Fl:x,Gh:b,Gl:g,Hh:E,Hl:S}=this;for(let B=0;B<80;B++){let k=qt(u,d,14)^qt(u,d,18)^pe(u,d,41),M=Vt(u,d,14)^Vt(u,d,18)^ye(u,d,41),O=u&h^~u&b,P=d&x^~d&g,H=no(S,M,P,si[B],Kt[B]),v=ro(H,E,k,O,oi[B],Ot[B]),N=H|0,K=qt(r,o,28)^pe(r,o,34)^pe(r,o,39),U=Vt(r,o,28)^ye(r,o,34)^ye(r,o,39),w=r&s^r&c^s&c,y=o&i^o&f^i&f;E=b|0,S=g|0,b=h|0,g=x|0,h=u|0,x=d|0,{h:u,l:d}=xt(l|0,a|0,v|0,N|0),l=c|0,a=f|0,c=s|0,f=i|0,s=r|0,i=o|0;let p=Qr(N,U,y);r=Jr(p,v,K,w),o=p|0}({h:r,l:o}=xt(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=xt(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:f}=xt(this.Ch|0,this.Cl|0,c|0,f|0),{h:l,l:a}=xt(this.Dh|0,this.Dl|0,l|0,a|0),{h:u,l:d}=xt(this.Eh|0,this.El|0,u|0,d|0),{h,l:x}=xt(this.Fh|0,this.Fl|0,h|0,x|0),{h:b,l:g}=xt(this.Gh|0,this.Gl|0,b|0,g|0),{h:E,l:S}=xt(this.Hh|0,this.Hl|0,E|0,S|0),this.set(r,o,s,i,c,f,l,a,u,d,h,x,b,g,E,S)}roundClean(){nt(Ot,Kt)}destroy(){nt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Un=class extends kn{Ah=st[0]|0;Al=st[1]|0;Bh=st[2]|0;Bl=st[3]|0;Ch=st[4]|0;Cl=st[5]|0;Dh=st[6]|0;Dl=st[7]|0;Eh=st[8]|0;El=st[9]|0;Fh=st[10]|0;Fl=st[11]|0;Gh=st[12]|0;Gl=st[13]|0;Hh=st[14]|0;Hl=st[15]|0;constructor(){super(48)}};var $=re(()=>new In,kt(1));var so=re(()=>new Un,kt(2));function Cn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ii(e){if(!Cn(e))throw new Error("Uint8Array expected")}function ao(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function ci(e){if(typeof e!="function")throw new Error("function expected");return!0}function jt(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Hn(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Rn(e){if(!Array.isArray(e))throw new Error("array expected")}function Pe(e,t){if(!ao(!0,t))throw new Error(`${e}: array of strings expected`)}function lo(e,t){if(!ao(!1,t))throw new Error(`${e}: array of numbers expected`)}function Nn(...e){let t=s=>s,n=(s,i)=>c=>s(i(c)),r=e.map(s=>s.encode).reduceRight(n,t),o=e.map(s=>s.decode).reduce(n,t);return{encode:r,decode:o}}function Mn(e){let t=typeof e=="string"?e.split(""):e,n=t.length;Pe("alphabet",t);let r=new Map(t.map((o,s)=>[o,s]));return{encode:o=>(Rn(o),o.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${e}`);return t[s]})),decode:o=>(Rn(o),o.map(s=>{jt("alphabet.decode",s);let i=r.get(s);if(i===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${e}`);return i}))}}function Dn(e=""){return jt("join",e),{encode:t=>(Pe("join.decode",t),t.join(e)),decode:t=>(jt("join.decode",t),t.split(e))}}function fi(e,t="="){return Hn(e),jt("padding",t),{encode(n){for(Pe("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){Pe("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}var uo=(e,t)=>t===0?e:uo(t,e%t),qe=(e,t)=>e+(t-uo(e,t)),De=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function On(e,t,n,r){if(Rn(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(qe(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${qe(t,n)}`);let o=0,s=0,i=De[t],c=De[n]-1,f=[];for(let l of e){if(Hn(l),l>=i)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(o=o<<t|l,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=n;s-=n)f.push((o>>s-n&c)>>>0);let a=De[s];if(a===void 0)throw new Error("invalid carry");o&=a-1}if(o=o<<n-s&c,!r&&s>=t)throw new Error("Excess padding");if(!r&&o>0)throw new Error(`Non-zero padding: ${o}`);return r&&s>0&&f.push(o>>>0),f}function Pn(e,t=!1){if(Hn(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(qe(8,e)>32||qe(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Cn(n))throw new Error("radix2.encode input should be Uint8Array");return On(Array.from(n),8,e,!t)},decode:n=>(lo("radix2.decode",n),Uint8Array.from(On(n,e,8,t)))}}function io(e){return ci(e),function(...t){try{return e.apply(null,t)}catch{}}}var ai=typeof Uint8Array.from([]).toBase64=="function"&&typeof Uint8Array.fromBase64=="function",li=(e,t)=>{jt("base64",e);let n=t?/^[A-Za-z0-9=_-]+$/:/^[A-Za-z0-9=+/]+$/,r=t?"base64url":"base64";if(e.length>0&&!n.test(e))throw new Error("invalid base64");return Uint8Array.fromBase64(e,{alphabet:r,lastChunkHandling:"strict"})},qn=ai?{encode(e){return ii(e),e.toBase64()},decode(e){return li(e,!1)}}:Nn(Pn(6),Mn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),fi(6),Dn("")),tt=Nn(Pn(6),Mn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Dn(""));var Kn=Nn(Mn("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Dn("")),co=[996825010,642813549,513874426,1027748829,705979059];function ge(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<co.length;r++)(t>>r&1)===1&&(n^=co[r]);return n}function fo(e,t,n=1){let r=e.length,o=1;for(let s=0;s<r;s++){let i=e.charCodeAt(s);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);o=ge(o)^i>>5}o=ge(o);for(let s=0;s<r;s++)o=ge(o)^e.charCodeAt(s)&31;for(let s of t)o=ge(o)^s;for(let s=0;s<6;s++)o=ge(o);return o^=n,Kn.encode(On([o%De[30]],30,5,!1))}function ui(e){let t=e==="bech32"?1:734539939,n=Pn(5),r=n.decode,o=n.encode,s=io(r);function i(u,d,h=90){jt("bech32.encode prefix",u),Cn(d)&&(d=Array.from(d)),lo("bech32.encode",d);let x=u.length;if(x===0)throw new TypeError(`Invalid prefix length ${x}`);let b=x+7+d.length;if(h!==!1&&b>h)throw new TypeError(`Length ${b} exceeds limit ${h}`);let g=u.toLowerCase(),E=fo(g,d,t);return`${g}1${Kn.encode(d)}${E}`}function c(u,d=90){jt("bech32.decode input",u);let h=u.length;if(h<8||d!==!1&&h>d)throw new TypeError(`invalid string length: ${h} (${u}). Expected (8..${d})`);let x=u.toLowerCase();if(u!==x&&u!==u.toUpperCase())throw new Error("String must be lowercase or uppercase");let b=x.lastIndexOf("1");if(b===0||b===-1)throw new Error('Letter "1" must be present between prefix and data only');let g=x.slice(0,b),E=x.slice(b+1);if(E.length<6)throw new Error("Data must be at least 6 characters long");let S=Kn.decode(E).slice(0,-6),B=fo(g,S,t);if(!E.endsWith(B))throw new Error(`Invalid checksum in ${u}: expected "${B}"`);return{prefix:g,words:S}}let f=io(c);function l(u){let{prefix:d,words:h}=c(u,!1);return{prefix:d,words:h,bytes:r(h)}}function a(u,d){return i(u,o(d))}return{encode:i,decode:c,encodeFromBytes:a,decodeToBytes:l,decodeUnsafe:f,fromWords:r,fromWordsUnsafe:s,toWords:o}}var rt=ui("bech32");function hi(e,t,n,r){ut(e);let o=Ce({dkLen:32,asyncTick:10},r),{c:s,dkLen:i,asyncTick:c}=o;if(X(s,"c"),X(i,"dkLen"),X(c,"asyncTick"),s<1)throw new Error("iterations (c) must be >= 1");let f=Sn(t,"password"),l=Sn(n,"salt"),a=new Uint8Array(i),u=gt.create(e,f),d=u._cloneInto().update(l);return{c:s,dkLen:i,asyncTick:c,DK:a,PRF:u,PRFSalt:d}}function pi(e,t,n,r,o){return e.destroy(),t.destroy(),r&&r.destroy(),nt(o),n}function Vn(e,t,n,r){let{c:o,dkLen:s,DK:i,PRF:c,PRFSalt:f}=hi(e,t,n,r),l,a=new Uint8Array(4),u=ee(a),d=new Uint8Array(c.outputLen);for(let h=1,x=0;x<s;h++,x+=c.outputLen){let b=i.subarray(x,x+c.outputLen);u.setInt32(0,h,!1),(l=f._cloneInto(l)).update(a).digestInto(d),b.set(d.subarray(0,b.length));for(let g=1;g<o;g++){c._cloneInto(l).update(d).digestInto(d);for(let E=0;E<b.length;E++)b[E]^=d[E]}}return pi(c,f,i,l,d)}function ho(e,t,n,r,o,s){let i=e[t++]^n[r++],c=e[t++]^n[r++],f=e[t++]^n[r++],l=e[t++]^n[r++],a=e[t++]^n[r++],u=e[t++]^n[r++],d=e[t++]^n[r++],h=e[t++]^n[r++],x=e[t++]^n[r++],b=e[t++]^n[r++],g=e[t++]^n[r++],E=e[t++]^n[r++],S=e[t++]^n[r++],B=e[t++]^n[r++],k=e[t++]^n[r++],M=e[t++]^n[r++],O=i,P=c,H=f,v=l,N=a,K=u,U=d,w=h,y=x,p=b,A=g,T=E,_=S,m=B,L=k,I=M;for(let R=0;R<8;R+=2)N^=Z(O+_|0,7),y^=Z(N+O|0,9),_^=Z(y+N|0,13),O^=Z(_+y|0,18),p^=Z(K+P|0,7),m^=Z(p+K|0,9),P^=Z(m+p|0,13),K^=Z(P+m|0,18),L^=Z(A+U|0,7),H^=Z(L+A|0,9),U^=Z(H+L|0,13),A^=Z(U+H|0,18),v^=Z(I+T|0,7),w^=Z(v+I|0,9),T^=Z(w+v|0,13),I^=Z(T+w|0,18),P^=Z(O+v|0,7),H^=Z(P+O|0,9),v^=Z(H+P|0,13),O^=Z(v+H|0,18),U^=Z(K+N|0,7),w^=Z(U+K|0,9),N^=Z(w+U|0,13),K^=Z(N+w|0,18),T^=Z(A+p|0,7),y^=Z(T+A|0,9),p^=Z(y+T|0,13),A^=Z(p+y|0,18),_^=Z(I+L|0,7),m^=Z(_+I|0,9),L^=Z(m+_|0,13),I^=Z(L+m|0,18);o[s++]=i+O|0,o[s++]=c+P|0,o[s++]=f+H|0,o[s++]=l+v|0,o[s++]=a+N|0,o[s++]=u+K|0,o[s++]=d+U|0,o[s++]=h+w|0,o[s++]=x+y|0,o[s++]=b+p|0,o[s++]=g+A|0,o[s++]=E+T|0,o[s++]=S+_|0,o[s++]=B+m|0,o[s++]=k+L|0,o[s++]=M+I|0}function jn(e,t,n,r,o){let s=r+0,i=r+16*o;for(let c=0;c<16;c++)n[i+c]=e[t+(2*o-1)*16+c];for(let c=0;c<o;c++,s+=16,t+=16)ho(n,i,e,t,n,s),c>0&&(i+=16),ho(n,s,e,t+=16,n,i)}function yi(e,t,n){let r=Ce({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:o,r:s,p:i,dkLen:c,asyncTick:f,maxmem:l,onProgress:a}=r;if(X(o,"N"),X(s,"r"),X(i,"p"),X(c,"dkLen"),X(f,"asyncTick"),X(l,"maxmem"),a!==void 0&&typeof a!="function")throw new Error("progressCb must be a function");let u=128*s,d=u/4,h=Math.pow(2,32);if(o<=1||(o&o-1)!==0||o>h)throw new Error('"N" expected a power of 2, and 2^1 <= N <= 2^32');if(i<1||i>(h-1)*32/u)throw new Error('"p" expected integer 1..((2^32 - 1) * 32) / (128 * r)');if(c<1||c>(h-1)*32)throw new Error('"dkLen" expected integer 1..(2^32 - 1) * 32');if(u*(o+i)>l)throw new Error('"maxmem" limit was hit, expected 128*r*(N+p) <= "maxmem"='+l);let b=Vn($,e,t,{c:1,dkLen:u*i}),g=It(b),E=It(new Uint8Array(u*o)),S=It(new Uint8Array(u)),B=()=>{};if(a){let k=2*o*i,M=Math.max(Math.floor(k/1e4),1),O=0;B=()=>{O++,a&&(!(O%M)||O===k)&&a(O/k)}}return{N:o,r:s,p:i,dkLen:c,blockSize32:d,V:E,B32:g,B:b,tmp:S,blockMixCb:B,asyncTick:f}}function gi(e,t,n,r,o){let s=Vn($,e,n,{c:1,dkLen:t});return nt(n,r,o),s}function Zn(e,t,n){let{N:r,r:o,p:s,dkLen:i,blockSize32:c,V:f,B32:l,B:a,tmp:u,blockMixCb:d}=yi(e,t,n);ne(l);for(let h=0;h<s;h++){let x=c*h;for(let b=0;b<c;b++)f[b]=l[x+b];for(let b=0,g=0;b<r-1;b++)jn(f,g,f,g+=c,o),d();jn(f,(r-1)*c,l,x,o),d();for(let b=0;b<r;b++){let g=(l[x+c-16]&r-1)>>>0;for(let E=0;E<c;E++)u[E]=l[x+E]^f[g*c+E];jn(u,0,l,x,o),d()}}return ne(l),gi(e,i,a,f,u)}function xi(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ve(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function je(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function ot(e,t,n=""){let r=xi(e),o=e?.length,s=t!==void 0;if(!r||s&&o!==t){let i=n&&`"${n}" `,c=s?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(i+"expected Uint8Array"+c+", got "+f)}return e}function Gn(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function po(e,t){ot(e,void 0,"output");let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function St(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function vt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function bi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}var wi=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function yo(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function go(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}var zn=(e,t)=>{function n(r,...o){if(ot(r,void 0,"key"),!wi)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let a=o[0];ot(a,e.varSizeNonce?void 0:e.nonceLength,"nonce")}let s=e.tagLength;s&&o[1]!==void 0&&ot(o[1],void 0,"AAD");let i=t(r,...o),c=(a,u)=>{if(u!==void 0){if(a!==2)throw new Error("cipher output not supported");ot(u,void 0,"output")}},f=!1;return{encrypt(a,u){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,ot(a),c(i.encrypt.length,u),i.encrypt(a,u)},decrypt(a,u){if(ot(a),s&&a.length<s)throw new Error('"ciphertext" expected length bigger than tagLength='+s);return c(i.decrypt.length,u),i.decrypt(a,u)}}}return Object.assign(n,e),n};function Xn(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error('"output" expected Uint8Array of length '+e+", got: "+t.length);if(n&&!mi(t))throw new Error("invalid output, must be aligned");return t}function xo(e,t,n){Ve(n);let r=new Uint8Array(16),o=bi(r);return o.setBigUint64(0,BigInt(t),n),o.setBigUint64(8,BigInt(e),n),r}function mi(e){return e.byteOffset%4===0}function oe(e){return Uint8Array.from(e)}var wo=e=>Uint8Array.from(e.split(""),t=>t.charCodeAt(0)),Ei=wo("expand 16-byte k"),Bi=wo("expand 32-byte k"),Ai=St(Ei),Si=St(Bi);function C(e,t){return e<<t|e>>>32-t}function Fn(e){return e.byteOffset%4===0}var Ze=64,vi=16,mo=2**32-1,bo=Uint32Array.of();function Li(e,t,n,r,o,s,i,c){let f=o.length,l=new Uint8Array(Ze),a=St(l),u=Fn(o)&&Fn(s),d=u?St(o):bo,h=u?St(s):bo;for(let x=0;x<f;i++){if(e(t,n,r,a,i,c),i>=mo)throw new Error("arx: counter overflow");let b=Math.min(Ze,f-x);if(u&&b===Ze){let g=x/4;if(x%4!==0)throw new Error("arx: invalid block position");for(let E=0,S;E<vi;E++)S=g+E,h[S]=d[S]^a[E];x+=Ze;continue}for(let g=0,E;g<b;g++)E=x+g,s[E]=o[E]^l[g];x+=b}}function $n(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:s,rounds:i}=yo({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return je(o),je(i),Ve(s),Ve(n),(c,f,l,a,u=0)=>{ot(c,void 0,"key"),ot(f,void 0,"nonce"),ot(l,void 0,"data");let d=l.length;if(a===void 0&&(a=new Uint8Array(d)),ot(a,void 0,"output"),je(u),u<0||u>=mo)throw new Error("arx: counter overflow");if(a.length<d)throw new Error(`arx: output (${a.length}) is shorter than data (${d})`);let h=[],x=c.length,b,g;if(x===32)h.push(b=oe(c)),g=Si;else if(x===16&&n)b=new Uint8Array(32),b.set(c),b.set(c,16),g=Ai,h.push(b);else throw ot(c,32,"arx key"),new Error("invalid key size");Fn(f)||h.push(f=oe(f));let E=St(b);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(g,E,St(f.subarray(0,16)),E),f=f.subarray(16)}let S=16-o;if(S!==f.length)throw new Error(`arx: nonce must be ${S} or 16 bytes`);if(S!==12){let k=new Uint8Array(12);k.set(f,s?0:12-f.length),f=k,h.push(f)}let B=St(f);return Li(e,g,E,B,l,a,u,i),vt(...h),a}}function it(e,t){return e[t++]&255|(e[t++]&255)<<8}var Wn=class{blockLen=16;outputLen=16;buffer=new Uint8Array(16);r=new Uint16Array(10);h=new Uint16Array(10);pad=new Uint16Array(8);pos=0;finished=!1;constructor(t){t=oe(ot(t,32,"key"));let n=it(t,0),r=it(t,2),o=it(t,4),s=it(t,6),i=it(t,8),c=it(t,10),f=it(t,12),l=it(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|c<<2)&8191,this.r[7]=(c>>>11|f<<5)&8065,this.r[8]=(f>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let a=0;a<8;a++)this.pad[a]=it(t,16+2*a)}process(t,n,r=!1){let o=r?0:2048,{h:s,r:i}=this,c=i[0],f=i[1],l=i[2],a=i[3],u=i[4],d=i[5],h=i[6],x=i[7],b=i[8],g=i[9],E=it(t,n+0),S=it(t,n+2),B=it(t,n+4),k=it(t,n+6),M=it(t,n+8),O=it(t,n+10),P=it(t,n+12),H=it(t,n+14),v=s[0]+(E&8191),N=s[1]+((E>>>13|S<<3)&8191),K=s[2]+((S>>>10|B<<6)&8191),U=s[3]+((B>>>7|k<<9)&8191),w=s[4]+((k>>>4|M<<12)&8191),y=s[5]+(M>>>1&8191),p=s[6]+((M>>>14|O<<2)&8191),A=s[7]+((O>>>11|P<<5)&8191),T=s[8]+((P>>>8|H<<8)&8191),_=s[9]+(H>>>5|o),m=0,L=m+v*c+N*(5*g)+K*(5*b)+U*(5*x)+w*(5*h);m=L>>>13,L&=8191,L+=y*(5*d)+p*(5*u)+A*(5*a)+T*(5*l)+_*(5*f),m+=L>>>13,L&=8191;let I=m+v*f+N*c+K*(5*g)+U*(5*b)+w*(5*x);m=I>>>13,I&=8191,I+=y*(5*h)+p*(5*d)+A*(5*u)+T*(5*a)+_*(5*l),m+=I>>>13,I&=8191;let R=m+v*l+N*f+K*c+U*(5*g)+w*(5*b);m=R>>>13,R&=8191,R+=y*(5*x)+p*(5*h)+A*(5*d)+T*(5*u)+_*(5*a),m+=R>>>13,R&=8191;let z=m+v*a+N*l+K*f+U*c+w*(5*g);m=z>>>13,z&=8191,z+=y*(5*b)+p*(5*x)+A*(5*h)+T*(5*d)+_*(5*u),m+=z>>>13,z&=8191;let V=m+v*u+N*a+K*l+U*f+w*c;m=V>>>13,V&=8191,V+=y*(5*g)+p*(5*b)+A*(5*x)+T*(5*h)+_*(5*d),m+=V>>>13,V&=8191;let q=m+v*d+N*u+K*a+U*l+w*f;m=q>>>13,q&=8191,q+=y*c+p*(5*g)+A*(5*b)+T*(5*x)+_*(5*h),m+=q>>>13,q&=8191;let j=m+v*h+N*d+K*u+U*a+w*l;m=j>>>13,j&=8191,j+=y*f+p*c+A*(5*g)+T*(5*b)+_*(5*x),m+=j>>>13,j&=8191;let F=m+v*x+N*h+K*d+U*u+w*a;m=F>>>13,F&=8191,F+=y*l+p*f+A*c+T*(5*g)+_*(5*b),m+=F>>>13,F&=8191;let W=m+v*b+N*x+K*h+U*d+w*u;m=W>>>13,W&=8191,W+=y*a+p*l+A*f+T*c+_*(5*g),m+=W>>>13,W&=8191;let G=m+v*g+N*b+K*x+U*h+w*d;m=G>>>13,G&=8191,G+=y*u+p*a+A*l+T*f+_*c,m+=G>>>13,G&=8191,m=(m<<2)+m|0,m=m+L|0,L=m&8191,m=m>>>13,I+=m,s[0]=L,s[1]=I,s[2]=R,s[3]=z,s[4]=V,s[5]=q,s[6]=j,s[7]=F,s[8]=W,s[9]=G}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=o,o=t[c]>>>13,t[c]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,r[0]=t[0]+5,o=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+o,o=r[c]>>>13,r[c]&=8191;r[9]-=8192;let s=(o^1)-1;for(let c=0;c<10;c++)r[c]&=s;s=~s;for(let c=0;c<10;c++)t[c]=t[c]&s|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+n[0];t[0]=i&65535;for(let c=1;c<8;c++)i=(t[c]+n[c]|0)+(i>>>16)|0,t[c]=i&65535;vt(r)}update(t){Gn(this),ot(t),t=oe(t);let{buffer:n,blockLen:r}=this,o=t.length;for(let s=0;s<o;){let i=Math.min(r-this.pos,o-s);if(i===r){for(;r<=o-s;s+=r)this.process(t,s);continue}n.set(t.subarray(s,s+i),this.pos),this.pos+=i,s+=i,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){vt(this.h,this.r,this.buffer,this.pad)}digestInto(t){Gn(this),po(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let s=0;for(let i=0;i<8;i++)t[s++]=r[i]>>>0,t[s++]=r[i]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function _i(e){let t=(r,o)=>e(o).update(r).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}var Eo=_i(e=>new Wn(e));function So(e,t,n,r,o,s=20){let i=e[0],c=e[1],f=e[2],l=e[3],a=t[0],u=t[1],d=t[2],h=t[3],x=t[4],b=t[5],g=t[6],E=t[7],S=o,B=n[0],k=n[1],M=n[2],O=i,P=c,H=f,v=l,N=a,K=u,U=d,w=h,y=x,p=b,A=g,T=E,_=S,m=B,L=k,I=M;for(let z=0;z<s;z+=2)O=O+N|0,_=C(_^O,16),y=y+_|0,N=C(N^y,12),O=O+N|0,_=C(_^O,8),y=y+_|0,N=C(N^y,7),P=P+K|0,m=C(m^P,16),p=p+m|0,K=C(K^p,12),P=P+K|0,m=C(m^P,8),p=p+m|0,K=C(K^p,7),H=H+U|0,L=C(L^H,16),A=A+L|0,U=C(U^A,12),H=H+U|0,L=C(L^H,8),A=A+L|0,U=C(U^A,7),v=v+w|0,I=C(I^v,16),T=T+I|0,w=C(w^T,12),v=v+w|0,I=C(I^v,8),T=T+I|0,w=C(w^T,7),O=O+K|0,I=C(I^O,16),A=A+I|0,K=C(K^A,12),O=O+K|0,I=C(I^O,8),A=A+I|0,K=C(K^A,7),P=P+U|0,_=C(_^P,16),T=T+_|0,U=C(U^T,12),P=P+U|0,_=C(_^P,8),T=T+_|0,U=C(U^T,7),H=H+w|0,m=C(m^H,16),y=y+m|0,w=C(w^y,12),H=H+w|0,m=C(m^H,8),y=y+m|0,w=C(w^y,7),v=v+N|0,L=C(L^v,16),p=p+L|0,N=C(N^p,12),v=v+N|0,L=C(L^v,8),p=p+L|0,N=C(N^p,7);let R=0;r[R++]=i+O|0,r[R++]=c+P|0,r[R++]=f+H|0,r[R++]=l+v|0,r[R++]=a+N|0,r[R++]=u+K|0,r[R++]=d+U|0,r[R++]=h+w|0,r[R++]=x+y|0,r[R++]=b+p|0,r[R++]=g+A|0,r[R++]=E+T|0,r[R++]=S+_|0,r[R++]=B+m|0,r[R++]=k+L|0,r[R++]=M+I|0}function Ti(e,t,n,r){let o=e[0],s=e[1],i=e[2],c=e[3],f=t[0],l=t[1],a=t[2],u=t[3],d=t[4],h=t[5],x=t[6],b=t[7],g=n[0],E=n[1],S=n[2],B=n[3];for(let M=0;M<20;M+=2)o=o+f|0,g=C(g^o,16),d=d+g|0,f=C(f^d,12),o=o+f|0,g=C(g^o,8),d=d+g|0,f=C(f^d,7),s=s+l|0,E=C(E^s,16),h=h+E|0,l=C(l^h,12),s=s+l|0,E=C(E^s,8),h=h+E|0,l=C(l^h,7),i=i+a|0,S=C(S^i,16),x=x+S|0,a=C(a^x,12),i=i+a|0,S=C(S^i,8),x=x+S|0,a=C(a^x,7),c=c+u|0,B=C(B^c,16),b=b+B|0,u=C(u^b,12),c=c+u|0,B=C(B^c,8),b=b+B|0,u=C(u^b,7),o=o+l|0,B=C(B^o,16),x=x+B|0,l=C(l^x,12),o=o+l|0,B=C(B^o,8),x=x+B|0,l=C(l^x,7),s=s+a|0,g=C(g^s,16),b=b+g|0,a=C(a^b,12),s=s+a|0,g=C(g^s,8),b=b+g|0,a=C(a^b,7),i=i+u|0,E=C(E^i,16),d=d+E|0,u=C(u^d,12),i=i+u|0,E=C(E^i,8),d=d+E|0,u=C(u^d,7),c=c+f|0,S=C(S^c,16),h=h+S|0,f=C(f^h,12),c=c+f|0,S=C(S^c,8),h=h+S|0,f=C(f^h,7);let k=0;r[k++]=o,r[k++]=s,r[k++]=i,r[k++]=c,r[k++]=g,r[k++]=E,r[k++]=S,r[k++]=B}var Ii=$n(So,{counterRight:!1,counterLength:4,allowShortKeys:!1}),ki=$n(So,{counterRight:!1,counterLength:8,extendNonceFn:Ti,allowShortKeys:!1});var Ui=new Uint8Array(16),Bo=(e,t)=>{e.update(t);let n=t.length%16;n&&e.update(Ui.subarray(n))},Ri=new Uint8Array(32);function Ao(e,t,n,r,o){o!==void 0&&ot(o,void 0,"AAD");let s=e(t,n,Ri),i=xo(r.length,o?o.length:0,!0),c=Eo.create(s);o&&Bo(c,o),Bo(c,r),c.update(i);let f=c.digest();return vt(s,i),f}var vo=e=>(t,n,r)=>({encrypt(s,i){let c=s.length;i=Xn(c+16,i,!1),i.set(s);let f=i.subarray(0,-16);e(t,n,f,f,1);let l=Ao(e,t,n,f,r);return i.set(l,c),vt(l),i},decrypt(s,i){i=Xn(s.length-16,i,!1);let c=s.subarray(0,-16),f=s.subarray(-16),l=Ao(e,t,n,c,r);if(!go(f,l))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),e(t,n,i,i,1),vt(l),i}}),ht=zn({blockSize:64,nonceLength:12,tagLength:16},vo(Ii)),If=zn({blockSize:64,nonceLength:24,tagLength:16},vo(ki));var Qn=BigInt(0),Yn=BigInt(1);function xe(e,t=""){if(typeof e!="boolean"){let n=t&&`"${t}" `;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function Lo(e){if(typeof e=="bigint"){if(!Ge(e))throw new Error("positive bigint expected, got "+e)}else X(e);return e}function be(e){let t=Lo(e).toString(16);return t.length&1?"0"+t:t}function _o(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Qn:BigInt("0x"+e)}function Ct(e){return _o(Dt(e))}function Ht(e){return _o(Dt(ze(D(e)).reverse()))}function se(e,t){X(t),e=Lo(e);let n=Pt(e.toString(16).padStart(t*2,"0"));if(n.length!==t)throw new Error("number too large");return n}function we(e,t){return se(e,t).reverse()}function ze(e){return Uint8Array.from(e)}function Nt(e){return Uint8Array.from(e,(t,n)=>{let r=t.charCodeAt(0);if(t.length!==1||r>127)throw new Error(`string contains non-ASCII character "${e[n]}" with code ${r} at position ${n}`);return r})}var Ge=e=>typeof e=="bigint"&&Qn<=e;function Oi(e,t,n){return Ge(e)&&Ge(t)&&Ge(n)&&t<=e&&e<n}function me(e,t,n,r){if(!Oi(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function Jn(e){let t;for(t=0;e>Qn;e>>=Yn,t+=1);return t}var Ee=e=>(Yn<<BigInt(e))-Yn;function To(e,t,n){if(X(e,"hashLen"),X(t,"qByteLen"),typeof n!="function")throw new Error("hmacFn must be a function");let r=g=>new Uint8Array(g),o=Uint8Array.of(),s=Uint8Array.of(0),i=Uint8Array.of(1),c=1e3,f=r(e),l=r(e),a=0,u=()=>{f.fill(1),l.fill(0),a=0},d=(...g)=>n(l,Y(f,...g)),h=(g=o)=>{l=d(s,g),f=d(),g.length!==0&&(l=d(i,g),f=d())},x=()=>{if(a++>=c)throw new Error("drbg: tried max amount of iterations");let g=0,E=[];for(;g<t;){f=d();let S=f.slice();E.push(S),g+=f.length}return Y(...E)};return(g,E)=>{u(),h(g);let S;for(;!(S=E(x()));)h();return u(),S}}function Zt(e,t={},n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(s,i,c){let f=e[s];if(c&&f===void 0)return;let l=typeof f;if(l!==i||f===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${l}`)}let o=(s,i)=>Object.entries(s).forEach(([c,f])=>r(c,f,i));o(t,!1),o(n,!0)}function tr(e){let t=new WeakMap;return(n,...r)=>{let o=t.get(n);if(o!==void 0)return o;let s=e(n,...r);return t.set(n,s),s}}var lt=BigInt(0),ct=BigInt(1),Gt=BigInt(2),Uo=BigInt(3),Ro=BigInt(4),Oo=BigInt(5),Ki=BigInt(7),Ko=BigInt(8),Ci=BigInt(9),Co=BigInt(16);function at(e,t){let n=e%t;return n>=lt?n:t+n}function pt(e,t,n){let r=e;for(;t-- >lt;)r*=r,r%=n;return r}function Io(e,t){if(e===lt)throw new Error("invert: expected non-zero number");if(t<=lt)throw new Error("invert: expected positive modulus, got "+t);let n=at(e,t),r=t,o=lt,s=ct,i=ct,c=lt;for(;n!==lt;){let l=r/n,a=r%n,u=o-i*l,d=s-c*l;r=n,n=a,o=i,s=c,i=u,c=d}if(r!==ct)throw new Error("invert: does not exist");return at(o,t)}function nr(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function Ho(e,t){let n=(e.ORDER+ct)/Ro,r=e.pow(t,n);return nr(e,r,t),r}function Hi(e,t){let n=(e.ORDER-Oo)/Ko,r=e.mul(t,Gt),o=e.pow(r,n),s=e.mul(t,o),i=e.mul(e.mul(s,Gt),o),c=e.mul(s,e.sub(i,e.ONE));return nr(e,c,t),c}function Ni(e){let t=Xe(e),n=No(e),r=n(t,t.neg(t.ONE)),o=n(t,r),s=n(t,t.neg(r)),i=(e+Ki)/Co;return(c,f)=>{let l=c.pow(f,i),a=c.mul(l,r),u=c.mul(l,o),d=c.mul(l,s),h=c.eql(c.sqr(a),f),x=c.eql(c.sqr(u),f);l=c.cmov(l,a,h),a=c.cmov(d,u,x);let b=c.eql(c.sqr(a),f),g=c.cmov(l,a,b);return nr(c,g,f),g}}function No(e){if(e<Uo)throw new Error("sqrt is not defined for small field");let t=e-ct,n=0;for(;t%Gt===lt;)t/=Gt,n++;let r=Gt,o=Xe(e);for(;ko(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return Ho;let s=o.pow(r,t),i=(t+ct)/Gt;return function(f,l){if(f.is0(l))return l;if(ko(f,l)!==1)throw new Error("Cannot find square root");let a=n,u=f.mul(f.ONE,s),d=f.pow(l,t),h=f.pow(l,i);for(;!f.eql(d,f.ONE);){if(f.is0(d))return f.ZERO;let x=1,b=f.sqr(d);for(;!f.eql(b,f.ONE);)if(x++,b=f.sqr(b),x===a)throw new Error("Cannot find square root");let g=ct<<BigInt(a-x-1),E=f.pow(u,g);a=x,u=f.sqr(E),d=f.mul(d,u),h=f.mul(h,E)}return h}}function Mi(e){return e%Ro===Uo?Ho:e%Ko===Oo?Hi:e%Co===Ci?Ni(e):No(e)}var Di=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function rr(e){let t={ORDER:"bigint",BYTES:"number",BITS:"number"},n=Di.reduce((r,o)=>(r[o]="function",r),t);return Zt(e,n),e}function Pi(e,t,n){if(n<lt)throw new Error("invalid exponent, negatives unsupported");if(n===lt)return e.ONE;if(n===ct)return t;let r=e.ONE,o=t;for(;n>lt;)n&ct&&(r=e.mul(r,o)),o=e.sqr(o),n>>=ct;return r}function Be(e,t,n=!1){let r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((i,c,f)=>e.is0(c)?i:(r[f]=i,e.mul(i,c)),e.ONE),s=e.inv(o);return t.reduceRight((i,c,f)=>e.is0(c)?i:(r[f]=e.mul(i,r[f]),e.mul(i,c)),s),r}function ko(e,t){let n=(e.ORDER-ct)/Gt,r=e.pow(t,n),o=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),i=e.eql(r,e.neg(e.ONE));if(!o&&!s&&!i)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function qi(e,t){t!==void 0&&X(t);let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}var er=class{ORDER;BITS;BYTES;isLE;ZERO=lt;ONE=ct;_lengths;_sqrt;_mod;constructor(t,n={}){if(t<=lt)throw new Error("invalid field: expected ORDER > 0, got "+t);let r;this.isLE=!1,n!=null&&typeof n=="object"&&(typeof n.BITS=="number"&&(r=n.BITS),typeof n.sqrt=="function"&&(this.sqrt=n.sqrt),typeof n.isLE=="boolean"&&(this.isLE=n.isLE),n.allowedLengths&&(this._lengths=n.allowedLengths?.slice()),typeof n.modFromBytes=="boolean"&&(this._mod=n.modFromBytes));let{nBitLength:o,nByteLength:s}=qi(t,r);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=s,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return at(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return lt<=t&&t<this.ORDER}is0(t){return t===lt}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&ct)===ct}neg(t){return at(-t,this.ORDER)}eql(t,n){return t===n}sqr(t){return at(t*t,this.ORDER)}add(t,n){return at(t+n,this.ORDER)}sub(t,n){return at(t-n,this.ORDER)}mul(t,n){return at(t*n,this.ORDER)}pow(t,n){return Pi(this,t,n)}div(t,n){return at(t*Io(n,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,n){return t+n}subN(t,n){return t-n}mulN(t,n){return t*n}inv(t){return Io(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=Mi(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?we(t,this.BYTES):se(t,this.BYTES)}fromBytes(t,n=!1){D(t);let{_lengths:r,BYTES:o,isLE:s,ORDER:i,_mod:c}=this;if(r){if(!r.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+r+" bytes, got "+t.length);let l=new Uint8Array(o);l.set(t,s?0:l.length-t.length),t=l}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let f=s?Ht(t):Ct(t);if(c&&(f=at(f,i)),!n&&!this.isValid(f))throw new Error("invalid field element: outside of range 0..ORDER");return f}invertBatch(t){return Be(this,t)}cmov(t,n,r){return r?n:t}};function Xe(e,t={}){return new er(e,t)}function Mo(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function or(e){let t=Mo(e);return t+Math.ceil(t/2)}function Do(e,t,n=!1){D(e);let r=e.length,o=Mo(t),s=or(t);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);let i=n?Ht(e):Ct(e),c=at(i,t-ct)+ct;return n?we(c,o):se(c,o)}var ie=BigInt(0),zt=BigInt(1);function Ae(e,t){let n=t.negate();return e?n:t}function fr(e,t){let n=Be(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}function jo(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function sr(e,t){jo(e,t);let n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,s=Ee(e),i=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:o,shiftBy:i}}function Po(e,t,n){let{windowSize:r,mask:o,maxNumber:s,shiftBy:i}=n,c=Number(e&o),f=e>>i;c>r&&(c-=s,f+=zt);let l=t*r,a=l+Math.abs(c)-1,u=c===0,d=c<0,h=t%2!==0;return{nextN:f,offset:a,isZero:u,isNeg:d,isNegF:h,offsetF:l}}var ir=new WeakMap,Zo=new WeakMap;function cr(e){return Zo.get(e)||1}function qo(e){if(e!==ie)throw new Error("invalid wNAF")}var Fe=class{BASE;ZERO;Fn;bits;constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>ie;)n&zt&&(r=r.add(o)),o=o.double(),n>>=zt;return r}precomputeWindow(t,n){let{windows:r,windowSize:o}=sr(n,this.bits),s=[],i=t,c=i;for(let f=0;f<r;f++){c=i,s.push(c);for(let l=1;l<o;l++)c=c.add(i),s.push(c);i=c.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,s=this.BASE,i=sr(t,this.bits);for(let c=0;c<i.windows;c++){let{nextN:f,offset:l,isZero:a,isNeg:u,isNegF:d,offsetF:h}=Po(r,c,i);r=f,a?s=s.add(Ae(d,n[h])):o=o.add(Ae(u,n[l]))}return qo(r),{p:o,f:s}}wNAFUnsafe(t,n,r,o=this.ZERO){let s=sr(t,this.bits);for(let i=0;i<s.windows&&r!==ie;i++){let{nextN:c,offset:f,isZero:l,isNeg:a}=Po(r,i,s);if(r=c,!l){let u=n[f];o=o.add(a?u.negate():u)}}return qo(r),o}getPrecomputes(t,n,r){let o=ir.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),ir.set(n,o))),o}cached(t,n,r){let o=cr(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){let s=cr(t);return s===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,o)}createCache(t,n){jo(n,this.bits),Zo.set(t,n),ir.delete(t)}hasCache(t){return cr(t)!==1}};function Go(e,t,n,r){let o=t,s=e.ZERO,i=e.ZERO;for(;n>ie||r>ie;)n&zt&&(s=s.add(o)),r&zt&&(i=i.add(o)),o=o.double(),n>>=zt,r>>=zt;return{p1:s,p2:i}}function Vo(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return rr(t),t}else return Xe(e,{isLE:n})}function zo(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let f of["p","n","h"]){let l=t[f];if(!(typeof l=="bigint"&&l>ie))throw new Error(`CURVE.${f} must be positive bigint`)}let o=Vo(t.p,n.Fp,r),s=Vo(t.n,n.Fn,r),c=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let f of c)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:s}}function $e(e,t){return function(r){let o=e(r);return{secretKey:o,publicKey:t(o)}}}var Se=BigInt(0),ce=BigInt(1),We=BigInt(2);function Vi(e){return Zt(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}function Xo(e){let t=Vi(e),{P:n,type:r,adjustScalarBytes:o,powPminus2:s,randomBytes:i}=t,c=r==="x25519";if(!c&&r!=="x448")throw new Error("invalid type");let f=i||Q,l=c?255:448,a=c?32:56,u=BigInt(c?9:5),d=BigInt(c?121665:39081),h=c?We**BigInt(254):We**BigInt(447),x=c?BigInt(8)*We**BigInt(251)-ce:BigInt(4)*We**BigInt(445)-ce,b=h+x+ce,g=y=>at(y,n),E=S(u);function S(y){return we(g(y),a)}function B(y){let p=ze(D(y,a,"uCoordinate"));return c&&(p[31]&=127),g(Ht(p))}function k(y){return Ht(o(ze(D(y,a,"scalar"))))}function M(y,p){let A=N(B(p),k(y));if(A===Se)throw new Error("invalid private or public key received");return S(A)}function O(y){return M(y,E)}let P=O,H=M;function v(y,p,A){let T=g(y*(p-A));return p=g(p-T),A=g(A+T),{x_2:p,x_3:A}}function N(y,p){me("u",y,Se,n),me("scalar",p,h,b);let A=p,T=y,_=ce,m=Se,L=y,I=ce,R=Se;for(let V=BigInt(l-1);V>=Se;V--){let q=A>>V&ce;R^=q,{x_2:_,x_3:L}=v(R,_,L),{x_2:m,x_3:I}=v(R,m,I),R=q;let j=_+m,F=g(j*j),W=_-m,G=g(W*W),J=F-G,Jt=L+I,Oe=L-I,ue=g(Oe*j),Dr=g(Jt*W),Pr=ue+Dr,qr=ue-Dr;L=g(Pr*Pr),I=g(T*g(qr*qr)),_=g(F*G),m=g(J*(F+g(d*J)))}({x_2:_,x_3:L}=v(R,_,L)),{x_2:m,x_3:I}=v(R,m,I);let z=s(m);return g(_*z)}let K={secretKey:a,publicKey:a,seed:a},U=(y=f(a))=>(D(y,K.seed,"seed"),y),w={randomSecretKey:U};return Object.freeze({keygen:$e(U,P),getSharedSecret:H,getPublicKey:P,scalarMult:M,scalarMultBase:O,utils:w,GuBytes:E.slice(),lengths:K})}var Fo=(e,t)=>(e+(e>=0?t:-t)/$o)/t;function ji(e,t,n){let[[r,o],[s,i]]=t,c=Fo(i*e,n),f=Fo(-o*e,n),l=e-c*r-f*s,a=-c*o-f*i,u=l<Lt,d=a<Lt;u&&(l=-l),d&&(a=-a);let h=Ee(Math.ceil(Jn(n)/2))+fe;if(l<Lt||l>=h||a<Lt||a>=h)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:u,k1:l,k2neg:d,k2:a}}function lr(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function ar(e,t){let n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return xe(n.lowS,"lowS"),xe(n.prehash,"prehash"),n.format!==void 0&&lr(n.format),n}var ur=class extends Error{constructor(t=""){super(t)}},Mt={Err:ur,_tlv:{encode:(e,t)=>{let{Err:n}=Mt;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");let r=t.length/2,o=be(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");let s=r>127?be(o.length/2|128):"";return be(e)+s+o+t},decode(e,t){let{Err:n}=Mt,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");let o=t[r++],s=!!(o&128),i=0;if(!s)i=o;else{let f=o&127;if(!f)throw new n("tlv.decode(long): indefinite length not supported");if(f>4)throw new n("tlv.decode(long): byte length is too big");let l=t.subarray(r,r+f);if(l.length!==f)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(let a of l)i=i<<8|a;if(r+=f,i<128)throw new n("tlv.decode(long): not minimal encoding")}let c=t.subarray(r,r+i);if(c.length!==i)throw new n("tlv.decode: wrong value length");return{v:c,l:t.subarray(r+i)}}},_int:{encode(e){let{Err:t}=Mt;if(e<Lt)throw new t("integer: negative integers are not allowed");let n=be(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){let{Err:t}=Mt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Ct(e)}},toSig(e){let{Err:t,_int:n,_tlv:r}=Mt,o=D(e,void 0,"signature"),{v:s,l:i}=r.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:c,l:f}=r.decode(2,s),{v:l,l:a}=r.decode(2,f);if(a.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(l)}},hexFromSig(e){let{_tlv:t,_int:n}=Mt,r=t.encode(2,n.encode(e.r)),o=t.encode(2,n.encode(e.s)),s=r+o;return t.encode(48,s)}},Lt=BigInt(0),fe=BigInt(1),$o=BigInt(2),Ye=BigInt(3),Zi=BigInt(4);function dr(e,t={}){let n=zo("weierstrass",e,t),{Fp:r,Fn:o}=n,s=n.CURVE,{h:i,n:c}=s;Zt(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});let{endo:f}=t;if(f&&(!r.is0(s.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let l=Yo(r,o);function a(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function u(U,w,y){let{x:p,y:A}=w.toAffine(),T=r.toBytes(p);if(xe(y,"isCompressed"),y){a();let _=!r.isOdd(A);return Y(Wo(_),T)}else return Y(Uint8Array.of(4),T,r.toBytes(A))}function d(U){D(U,void 0,"Point");let{publicKey:w,publicKeyUncompressed:y}=l,p=U.length,A=U[0],T=U.subarray(1);if(p===w&&(A===2||A===3)){let _=r.fromBytes(T);if(!r.isValid(_))throw new Error("bad point: is not on curve, wrong x");let m=b(_),L;try{L=r.sqrt(m)}catch(z){let V=z instanceof Error?": "+z.message:"";throw new Error("bad point: is not on curve, sqrt error"+V)}a();let I=r.isOdd(L);return(A&1)===1!==I&&(L=r.neg(L)),{x:_,y:L}}else if(p===y&&A===4){let _=r.BYTES,m=r.fromBytes(T.subarray(0,_)),L=r.fromBytes(T.subarray(_,_*2));if(!g(m,L))throw new Error("bad point: is not on curve");return{x:m,y:L}}else throw new Error(`bad point: got length ${p}, expected compressed=${w} or uncompressed=${y}`)}let h=t.toBytes||u,x=t.fromBytes||d;function b(U){let w=r.sqr(U),y=r.mul(w,U);return r.add(r.add(y,r.mul(U,s.a)),s.b)}function g(U,w){let y=r.sqr(w),p=b(U);return r.eql(y,p)}if(!g(s.Gx,s.Gy))throw new Error("bad curve params: generator point");let E=r.mul(r.pow(s.a,Ye),Zi),S=r.mul(r.sqr(s.b),BigInt(27));if(r.is0(r.add(E,S)))throw new Error("bad curve params: a or b");function B(U,w,y=!1){if(!r.isValid(w)||y&&r.is0(w))throw new Error(`bad point coordinate ${U}`);return w}function k(U){if(!(U instanceof v))throw new Error("Weierstrass Point expected")}function M(U){if(!f||!f.basises)throw new Error("no endo");return ji(U,f.basises,o.ORDER)}let O=tr((U,w)=>{let{X:y,Y:p,Z:A}=U;if(r.eql(A,r.ONE))return{x:y,y:p};let T=U.is0();w==null&&(w=T?r.ONE:r.inv(A));let _=r.mul(y,w),m=r.mul(p,w),L=r.mul(A,w);if(T)return{x:r.ZERO,y:r.ZERO};if(!r.eql(L,r.ONE))throw new Error("invZ was invalid");return{x:_,y:m}}),P=tr(U=>{if(U.is0()){if(t.allowInfinityPoint&&!r.is0(U.Y))return;throw new Error("bad point: ZERO")}let{x:w,y}=U.toAffine();if(!r.isValid(w)||!r.isValid(y))throw new Error("bad point: x or y not field elements");if(!g(w,y))throw new Error("bad point: equation left != right");if(!U.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function H(U,w,y,p,A){return y=new v(r.mul(y.X,U),y.Y,y.Z),w=Ae(p,w),y=Ae(A,y),w.add(y)}class v{static BASE=new v(s.Gx,s.Gy,r.ONE);static ZERO=new v(r.ZERO,r.ONE,r.ZERO);static Fp=r;static Fn=o;X;Y;Z;constructor(w,y,p){this.X=B("x",w),this.Y=B("y",y,!0),this.Z=B("z",p),Object.freeze(this)}static CURVE(){return s}static fromAffine(w){let{x:y,y:p}=w||{};if(!w||!r.isValid(y)||!r.isValid(p))throw new Error("invalid affine point");if(w instanceof v)throw new Error("projective point not allowed");return r.is0(y)&&r.is0(p)?v.ZERO:new v(y,p,r.ONE)}static fromBytes(w){let y=v.fromAffine(x(D(w,void 0,"point")));return y.assertValidity(),y}static fromHex(w){return v.fromBytes(Pt(w))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(w=8,y=!0){return K.createCache(this,w),y||this.multiply(Ye),this}assertValidity(){P(this)}hasEvenY(){let{y:w}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(w)}equals(w){k(w);let{X:y,Y:p,Z:A}=this,{X:T,Y:_,Z:m}=w,L=r.eql(r.mul(y,m),r.mul(T,A)),I=r.eql(r.mul(p,m),r.mul(_,A));return L&&I}negate(){return new v(this.X,r.neg(this.Y),this.Z)}double(){let{a:w,b:y}=s,p=r.mul(y,Ye),{X:A,Y:T,Z:_}=this,m=r.ZERO,L=r.ZERO,I=r.ZERO,R=r.mul(A,A),z=r.mul(T,T),V=r.mul(_,_),q=r.mul(A,T);return q=r.add(q,q),I=r.mul(A,_),I=r.add(I,I),m=r.mul(w,I),L=r.mul(p,V),L=r.add(m,L),m=r.sub(z,L),L=r.add(z,L),L=r.mul(m,L),m=r.mul(q,m),I=r.mul(p,I),V=r.mul(w,V),q=r.sub(R,V),q=r.mul(w,q),q=r.add(q,I),I=r.add(R,R),R=r.add(I,R),R=r.add(R,V),R=r.mul(R,q),L=r.add(L,R),V=r.mul(T,_),V=r.add(V,V),R=r.mul(V,q),m=r.sub(m,R),I=r.mul(V,z),I=r.add(I,I),I=r.add(I,I),new v(m,L,I)}add(w){k(w);let{X:y,Y:p,Z:A}=this,{X:T,Y:_,Z:m}=w,L=r.ZERO,I=r.ZERO,R=r.ZERO,z=s.a,V=r.mul(s.b,Ye),q=r.mul(y,T),j=r.mul(p,_),F=r.mul(A,m),W=r.add(y,p),G=r.add(T,_);W=r.mul(W,G),G=r.add(q,j),W=r.sub(W,G),G=r.add(y,A);let J=r.add(T,m);return G=r.mul(G,J),J=r.add(q,F),G=r.sub(G,J),J=r.add(p,A),L=r.add(_,m),J=r.mul(J,L),L=r.add(j,F),J=r.sub(J,L),R=r.mul(z,G),L=r.mul(V,F),R=r.add(L,R),L=r.sub(j,R),R=r.add(j,R),I=r.mul(L,R),j=r.add(q,q),j=r.add(j,q),F=r.mul(z,F),G=r.mul(V,G),j=r.add(j,F),F=r.sub(q,F),F=r.mul(z,F),G=r.add(G,F),q=r.mul(j,G),I=r.add(I,q),q=r.mul(J,G),L=r.mul(W,L),L=r.sub(L,q),q=r.mul(W,j),R=r.mul(J,R),R=r.add(R,q),new v(L,I,R)}subtract(w){return this.add(w.negate())}is0(){return this.equals(v.ZERO)}multiply(w){let{endo:y}=t;if(!o.isValidNot0(w))throw new Error("invalid scalar: out of range");let p,A,T=_=>K.cached(this,_,m=>fr(v,m));if(y){let{k1neg:_,k1:m,k2neg:L,k2:I}=M(w),{p:R,f:z}=T(m),{p:V,f:q}=T(I);A=z.add(q),p=H(y.beta,R,V,_,L)}else{let{p:_,f:m}=T(w);p=_,A=m}return fr(v,[p,A])[0]}multiplyUnsafe(w){let{endo:y}=t,p=this;if(!o.isValid(w))throw new Error("invalid scalar: out of range");if(w===Lt||p.is0())return v.ZERO;if(w===fe)return p;if(K.hasCache(this))return this.multiply(w);if(y){let{k1neg:A,k1:T,k2neg:_,k2:m}=M(w),{p1:L,p2:I}=Go(v,p,T,m);return H(y.beta,L,I,A,_)}else return K.unsafe(p,w)}toAffine(w){return O(this,w)}isTorsionFree(){let{isTorsionFree:w}=t;return i===fe?!0:w?w(v,this):K.unsafe(this,c).is0()}clearCofactor(){let{clearCofactor:w}=t;return i===fe?this:w?w(v,this):this.multiplyUnsafe(i)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}toBytes(w=!0){return xe(w,"isCompressed"),this.assertValidity(),h(v,this,w)}toHex(w=!0){return Dt(this.toBytes(w))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let N=o.BITS,K=new Fe(v,t.endo?Math.ceil(N/2):N);return v.BASE.precompute(8),v}function Wo(e){return Uint8Array.of(e?2:3)}function Yo(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function Gi(e,t={}){let{Fn:n}=e,r=t.randomBytes||Q,o=Object.assign(Yo(e.Fp,n),{seed:or(n.ORDER)});function s(h){try{let x=n.fromBytes(h);return n.isValidNot0(x)}catch{return!1}}function i(h,x){let{publicKey:b,publicKeyUncompressed:g}=o;try{let E=h.length;return x===!0&&E!==b||x===!1&&E!==g?!1:!!e.fromBytes(h)}catch{return!1}}function c(h=r(o.seed)){return Do(D(h,o.seed,"seed"),n.ORDER)}function f(h,x=!0){return e.BASE.multiply(n.fromBytes(h)).toBytes(x)}function l(h){let{secretKey:x,publicKey:b,publicKeyUncompressed:g}=o;if(!te(h)||"_lengths"in n&&n._lengths||x===b)return;let E=D(h,void 0,"key").length;return E===b||E===g}function a(h,x,b=!0){if(l(h)===!0)throw new Error("first arg must be private key");if(l(x)===!1)throw new Error("second arg must be public key");let g=n.fromBytes(h);return e.fromBytes(x).multiply(g).toBytes(b)}let u={isValidSecretKey:s,isValidPublicKey:i,randomSecretKey:c},d=$e(c,f);return Object.freeze({getPublicKey:f,getSharedSecret:a,keygen:d,Point:e,utils:u,lengths:o})}function hr(e,t,n={}){ut(t),Zt(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),n=Object.assign({},n);let r=n.randomBytes||Q,o=n.hmac||((y,p)=>gt(t,y,p)),{Fp:s,Fn:i}=e,{ORDER:c,BITS:f}=i,{keygen:l,getPublicKey:a,getSharedSecret:u,utils:d,lengths:h}=Gi(e,n),x={prehash:!0,lowS:typeof n.lowS=="boolean"?n.lowS:!0,format:"compact",extraEntropy:!1},b=c*$o<s.ORDER;function g(y){let p=c>>fe;return y>p}function E(y,p){if(!i.isValidNot0(p))throw new Error(`invalid signature ${y}: out of range 1..Point.Fn.ORDER`);return p}function S(){if(b)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function B(y,p){lr(p);let A=h.signature,T=p==="compact"?A:p==="recovered"?A+1:void 0;return D(y,T)}class k{r;s;recovery;constructor(p,A,T){if(this.r=E("r",p),this.s=E("s",A),T!=null){if(S(),![0,1,2,3].includes(T))throw new Error("invalid recovery id");this.recovery=T}Object.freeze(this)}static fromBytes(p,A=x.format){B(p,A);let T;if(A==="der"){let{r:I,s:R}=Mt.toSig(D(p));return new k(I,R)}A==="recovered"&&(T=p[0],A="compact",p=p.subarray(1));let _=h.signature/2,m=p.subarray(0,_),L=p.subarray(_,_*2);return new k(i.fromBytes(m),i.fromBytes(L),T)}static fromHex(p,A){return this.fromBytes(Pt(p),A)}assertRecovery(){let{recovery:p}=this;if(p==null)throw new Error("invalid recovery id: must be present");return p}addRecoveryBit(p){return new k(this.r,this.s,p)}recoverPublicKey(p){let{r:A,s:T}=this,_=this.assertRecovery(),m=_===2||_===3?A+c:A;if(!s.isValid(m))throw new Error("invalid recovery id: sig.r+curve.n != R.x");let L=s.toBytes(m),I=e.fromBytes(Y(Wo((_&1)===0),L)),R=i.inv(m),z=O(D(p,void 0,"msgHash")),V=i.create(-z*R),q=i.create(T*R),j=e.BASE.multiplyUnsafe(V).add(I.multiplyUnsafe(q));if(j.is0())throw new Error("invalid recovery: point at infinify");return j.assertValidity(),j}hasHighS(){return g(this.s)}toBytes(p=x.format){if(lr(p),p==="der")return Pt(Mt.hexFromSig(this));let{r:A,s:T}=this,_=i.toBytes(A),m=i.toBytes(T);return p==="recovered"?(S(),Y(Uint8Array.of(this.assertRecovery()),_,m)):Y(_,m)}toHex(p){return Dt(this.toBytes(p))}}let M=n.bits2int||function(p){if(p.length>8192)throw new Error("input is too large");let A=Ct(p),T=p.length*8-f;return T>0?A>>BigInt(T):A},O=n.bits2int_modN||function(p){return i.create(M(p))},P=Ee(f);function H(y){return me("num < 2^"+f,y,Lt,P),i.toBytes(y)}function v(y,p){return D(y,void 0,"message"),p?D(t(y),void 0,"prehashed message"):y}function N(y,p,A){let{lowS:T,prehash:_,extraEntropy:m}=ar(A,x);y=v(y,_);let L=O(y),I=i.fromBytes(p);if(!i.isValidNot0(I))throw new Error("invalid private key");let R=[H(I),H(L)];if(m!=null&&m!==!1){let j=m===!0?r(h.secretKey):m;R.push(D(j,void 0,"extraEntropy"))}let z=Y(...R),V=L;function q(j){let F=M(j);if(!i.isValidNot0(F))return;let W=i.inv(F),G=e.BASE.multiply(F).toAffine(),J=i.create(G.x);if(J===Lt)return;let Jt=i.create(W*i.create(V+J*I));if(Jt===Lt)return;let Oe=(G.x===J?0:2)|Number(G.y&fe),ue=Jt;return T&&g(Jt)&&(ue=i.neg(Jt),Oe^=1),new k(J,ue,b?void 0:Oe)}return{seed:z,k2sig:q}}function K(y,p,A={}){let{seed:T,k2sig:_}=N(y,p,A);return To(t.outputLen,i.BYTES,o)(T,_).toBytes(A.format)}function U(y,p,A,T={}){let{lowS:_,prehash:m,format:L}=ar(T,x);if(A=D(A,void 0,"publicKey"),p=v(p,m),!te(y)){let I=y instanceof k?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+I)}B(y,L);try{let I=k.fromBytes(y,L),R=e.fromBytes(A);if(_&&I.hasHighS())return!1;let{r:z,s:V}=I,q=O(p),j=i.inv(V),F=i.create(q*j),W=i.create(z*j),G=e.BASE.multiplyUnsafe(F).add(R.multiplyUnsafe(W));return G.is0()?!1:i.create(G.x)===z}catch{return!1}}function w(y,p,A={}){let{prehash:T}=ar(A,x);return p=v(p,T),k.fromBytes(y,"recovered").recoverPublicKey(p).toBytes()}return Object.freeze({keygen:l,getPublicKey:a,getSharedSecret:u,utils:d,lengths:h,Point:e,sign:K,verify:U,recoverPublicKey:w,Signature:k,hash:t})}var zi=BigInt(1),Qo=BigInt(2),Xi=BigInt(3),Fi=BigInt(5),Jf=BigInt(8),Jo=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed");function $i(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),s=Jo,c=e*e%s*e%s,f=pt(c,Qo,s)*c%s,l=pt(f,zi,s)*e%s,a=pt(l,Fi,s)*l%s,u=pt(a,t,s)*a%s,d=pt(u,n,s)*u%s,h=pt(d,r,s)*d%s,x=pt(h,o,s)*h%s,b=pt(x,o,s)*h%s,g=pt(b,t,s)*a%s;return{pow_p_5_8:pt(g,Qo,s)*e%s,b2:c}}function Wi(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var ae=(()=>{let e=Jo;return Xo({P:e,type:"x25519",powPminus2:t=>{let{pow_p_5_8:n,b2:r}=$i(t);return at(pt(n,Xi,e)*r,e)},adjustScalarBytes:Wi})})();var Yi={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Qi={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")};var Ji=dr(Yi),_t=hr(Ji,$);var tc=dr(Qi),ts=hr(tc,so);var ec=BigInt(0),ve=BigInt(1),nc=BigInt(2),rc=BigInt(7),oc=BigInt(256),sc=BigInt(113),rs=[],os=[],ss=[];for(let e=0,t=ve,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],rs.push(2*(5*r+n)),os.push((e+1)*(e+2)/2%64);let o=ec;for(let s=0;s<7;s++)t=(t<<ve^(t>>rc)*sc)%oc,t&nc&&(o^=ve<<(ve<<BigInt(s))-ve);ss.push(o)}var is=Me(ss,!0),ic=is[0],cc=is[1],es=(e,t,n)=>n>32?Wr(e,t,n):Fr(e,t,n),ns=(e,t,n)=>n>32?Yr(e,t,n):$r(e,t,n);function fc(e,t=24){let n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){let c=(i+8)%10,f=(i+2)%10,l=n[f],a=n[f+1],u=es(l,a,1)^n[c],d=ns(l,a,1)^n[c+1];for(let h=0;h<50;h+=10)e[i+h]^=u,e[i+h+1]^=d}let o=e[2],s=e[3];for(let i=0;i<24;i++){let c=os[i],f=es(o,s,c),l=ns(o,s,c),a=rs[i];o=e[a],s=e[a+1],e[a]=f,e[a+1]=l}for(let i=0;i<50;i+=10){for(let c=0;c<10;c++)n[c]=e[i+c];for(let c=0;c<10;c++)e[i+c]^=~n[(c+2)%10]&n[(c+4)%10]}e[0]^=ic[r],e[1]^=cc[r]}nt(n)}var Qe=class e{state;pos=0;posOut=0;finished=!1;state32;destroyed=!1;blockLen;suffix;outputLen;enableXOF=!1;rounds;constructor(t,n,r,o=!1,s=24){if(this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=o,this.rounds=s,X(r,"outputLen"),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=It(this.state)}clone(){return this._cloneInto()}keccak(){ne(this.state32),fc(this.state32,this.rounds),ne(this.state32),this.posOut=0,this.pos=0}update(t){Et(this),D(t);let{blockLen:n,state:r}=this,o=t.length;for(let s=0;s<o;){let i=Math.min(n-this.pos,o-s);for(let c=0;c<i;c++)r[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:n,pos:r,blockLen:o}=this;t[r]^=n,(n&128)!==0&&r===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){Et(this,!1),D(t),this.finish();let n=this.state,{blockLen:r}=this;for(let o=0,s=t.length;o<s;){this.posOut>=r&&this.keccak();let i=Math.min(r-this.posOut,s-o);t.set(n.subarray(this.posOut,this.posOut+i),o),this.posOut+=i,o+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return X(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Ke(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,nt(this.state)}_cloneInto(t){let{blockLen:n,suffix:r,outputLen:o,rounds:s,enableXOF:i}=this;return t||=new e(n,r,o,i,s),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=o,t.enableXOF=i,t.destroyed=this.destroyed,t}},cs=(e,t,n,r={})=>re(()=>new Qe(t,e,n),r);var Xt=cs(6,136,32,kt(8));var fs=cs(6,72,64,kt(10));var as=(e,t,n,r={})=>re((o={})=>new Qe(t,e,o.dkLen===void 0?n:o.dkLen,!0),r),ls=as(31,168,16,kt(11)),bt=as(31,136,32,kt(12));function pr(e){if(!Number.isSafeInteger(e)||e<0||e>4294967295)throw new Error("wrong u32 integer:"+e);return e}function ds(e){return pr(e),(e&e-1)===0&&e!==0}function yr(e,t){pr(e);let n=0;for(let r=0;r<t;r++,e>>>=1)n=n<<1|e&1;return n}function hs(e){return pr(e),31-Math.clz32(e)}function us(e){let t=e.length;if(t<2||!ds(t))throw new Error("n must be a power of 2 and greater than 1. Got "+t);let n=hs(t);for(let r=0;r<t;r++){let o=yr(r,n);if(r<o){let s=e[r];e[r]=e[o],e[o]=s}}return e}var gr=(e,t)=>{let{N:n,roots:r,dit:o,invertButterflies:s=!1,skipStages:i=0,brp:c=!0}=t,f=hs(n);if(!ds(n))throw new Error("FFT: Polynomial size should be power of two");let l=o!==s;return a=>{if(a.length!==n)throw new Error("FFT: wrong Polynomial length");o&&c&&us(a);for(let u=0,d=1;u<f-i;u++){let h=o?u+1+i:f-u,x=1<<h,b=x>>1,g=n>>h;for(let E=0;E<n;E+=x)for(let S=0,B=d++;S<b;S++){let k=s?o?n-B:B:S*g,M=E+S,O=E+S+b,P=r[k],H=a[O],v=a[M];if(l){let N=e.mul(H,P);a[M]=e.add(v,N),a[O]=e.sub(v,N)}else s?(a[M]=e.add(H,v),a[O]=e.mul(e.sub(H,v),P)):(a[M]=e.add(v,H),a[O]=e.mul(e.sub(v,H),P))}}return!o&&c&&us(a),a}};var wt=Q;function Je(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function ps(e){return Uint8Array.from(e)}function Ft(e,...t){let n=o=>typeof o=="number"?o:o.bytesLen,r=t.reduce((o,s)=>o+n(s),0);return{bytesLen:r,encode:o=>{let s=new Uint8Array(r);for(let i=0,c=0;i<t.length;i++){let f=t[i],l=n(f),a=typeof f=="number"?o[i]:f.encode(o[i]);D(a,l,e),s.set(a,c),typeof f!="number"&&a.fill(0),c+=l}return s},decode:o=>{D(o,r,e);let s=[];for(let i of t){let c=n(i),f=o.subarray(0,c);s.push(typeof i=="number"?f:i.decode(f)),o=o.subarray(c)}return s}}}function tn(e,t){let n=t*e.bytesLen;return{bytesLen:n,encode:r=>{if(r.length!==t)throw new Error(`vecCoder.encode: wrong length=${r.length}. Expected: ${t}`);let o=new Uint8Array(n);for(let s=0,i=0;s<r.length;s++){let c=e.encode(r[s]);o.set(c,i),c.fill(0),i+=c.length}return o},decode:r=>{D(r,n);let o=[];for(let s=0;s<r.length;s+=e.bytesLen)o.push(e.decode(r.subarray(s,s+e.bytesLen)));return o}}}function et(...e){for(let t of e)if(Array.isArray(t))for(let n of t)n.fill(0);else t.fill(0)}function xr(e){return(1<<e)-1}var ua=Uint8Array.of();var ys=e=>{let{newPoly:t,N:n,Q:r,F:o,ROOT_OF_UNITY:s,brvBits:i,isKyber:c}=e,f=(S,B=r)=>{let k=S%B|0;return(k>=0?k|0:B+k|0)|0},l=(S,B=r)=>{let k=f(S,B)|0;return(k>B>>1?k-B|0:k)|0};function a(){let S=t(n);for(let B=0;B<n;B++){let k=yr(B,i),M=BigInt(s)**BigInt(k)%BigInt(r);S[B]=Number(M)|0}return S}let u=a(),d={add:(S,B)=>f((S|0)+(B|0))|0,sub:(S,B)=>f((S|0)-(B|0))|0,mul:(S,B)=>f((S|0)*(B|0))|0,inv:S=>{throw new Error("not implemented")}},h={N:n,roots:u,invertButterflies:!0,skipStages:c?1:0,brp:!1},x=gr(d,{dit:!1,...h}),b=gr(d,{dit:!0,...h});return{mod:f,smod:l,nttZetas:u,NTT:{encode:S=>x(S),decode:S=>{b(S);for(let B=0;B<S.length;B++)S[B]=f(o*S[B]);return S}},bitsCoder:(S,B)=>{let k=xr(S),M=S*(n/8);return{bytesLen:M,encode:O=>{let P=new Uint8Array(M);for(let H=0,v=0,N=0,K=0;H<O.length;H++)for(v|=(B.encode(O[H])&k)<<N,N+=S;N>=8;N-=8,v>>=8)P[K++]=v&xr(N);return P},decode:O=>{let P=t(n);for(let H=0,v=0,N=0,K=0;H<O.length;H++)for(v|=O[H]<<N,N+=8;N>=S;N-=S,v>>=S)P[K++]=B.decode(v&k);return P}}}}},ac=e=>(t,n)=>{n||(n=e.blockLen);let r=new Uint8Array(t.length+2);r.set(t);let o=t.length,s=new Uint8Array(n),i=e.create({}),c=0,f=0;return{stats:()=>({calls:c,xofs:f}),get:(l,a)=>(r[o+0]=l,r[o+1]=a,i.destroy(),i=e.create({}).update(r),c++,()=>(f++,i.xofInto(s))),clean:()=>{i.destroy(),et(s,r)}}},gs=ac(ls);var ft=256,Tt=3329,lc=3303,uc=17,{mod:Te,nttZetas:dc,NTT:$t,bitsCoder:hc}=ys({N:ft,Q:Tt,F:lc,ROOT_OF_UNITY:uc,newPoly:e=>new Uint16Array(e),brvBits:7,isKyber:!0}),br={512:{N:ft,Q:Tt,K:2,ETA1:3,ETA2:2,du:10,dv:4,RBGstrength:128},768:{N:ft,Q:Tt,K:3,ETA1:2,ETA2:2,du:10,dv:4,RBGstrength:192},1024:{N:ft,Q:Tt,K:4,ETA1:2,ETA2:2,du:11,dv:5,RBGstrength:256}},pc=e=>{if(e>=12)return{encode:n=>n,decode:n=>n};let t=2**(e-1);return{encode:n=>((n<<e)+Tt/2)/Tt,decode:n=>n*Tt+t>>>e}},Le=e=>hc(e,pc(e));function Wt(e,t){for(let n=0;n<ft;n++)e[n]=Te(e[n]+t[n])}function yc(e,t){for(let n=0;n<ft;n++)e[n]=Te(e[n]-t[n])}function gc(e,t,n,r,o){let s=Te(t*r*o+e*n),i=Te(e*r+t*n);return{c0:s,c1:i}}function en(e,t){for(let n=0;n<ft/2;n++){let r=dc[64+(n>>1)];n&1&&(r=-r);let{c0:o,c1:s}=gc(e[2*n+0],e[2*n+1],t[2*n+0],t[2*n+1],r);e[2*n+0]=o,e[2*n+1]=s}return e}function xs(e){let t=new Uint16Array(ft);for(let n=0;n<ft;){let r=e();if(r.length%3)throw new Error("SampleNTT: unaligned block");for(let o=0;n<ft&&o+3<=r.length;o+=3){let s=(r[o+0]>>0|r[o+1]<<8)&4095,i=(r[o+1]>>4|r[o+2]<<4)&4095;s<Tt&&(t[n++]=s),n<ft&&i<Tt&&(t[n++]=i)}}return t}function _e(e,t,n,r){let o=e(r*ft/4,t,n),s=new Uint16Array(ft),i=It(o),c=0;for(let f=0,l=0,a=0,u=0;f<i.length;f++){let d=i[f];for(let h=0;h<32;h++)a+=d&1,d>>=1,c+=1,c===r?(u=a,a=0):c===2*r&&(s[l++]=Te(u-a),a=0,c=0)}if(c)throw new Error(`sampleCBD: leftover bits: ${c}`);return s}var xc=e=>{let{K:t,PRF:n,XOF:r,HASH512:o,ETA1:s,ETA2:i,du:c,dv:f}=e,l=Le(1),a=Le(f),u=Le(c),d=Ft("publicKey",tn(Le(12),t),32),h=tn(Le(12),t),x=Ft("ciphertext",tn(u,t),a),b=Ft("seed",32,32);return{secretCoder:h,lengths:{secretKey:h.bytesLen,publicKey:d.bytesLen,cipherText:x.bytesLen},keygen:g=>{D(g,32,"seed");let E=new Uint8Array(33);E.set(g),E[32]=t;let S=o(E),[B,k]=b.decode(S),M=[],O=[];for(let v=0;v<t;v++)M.push($t.encode(_e(n,k,v,s)));let P=r(B);for(let v=0;v<t;v++){let N=$t.encode(_e(n,k,t+v,s));for(let K=0;K<t;K++){let U=xs(P.get(K,v));Wt(N,en(U,M[K]))}O.push(N)}P.clean();let H={publicKey:d.encode([O,B]),secretKey:h.encode(M)};return et(B,k,M,O,E,S),H},encrypt:(g,E,S)=>{let[B,k]=d.decode(g),M=[];for(let K=0;K<t;K++)M.push($t.encode(_e(n,S,K,s)));let O=r(k),P=new Uint16Array(ft),H=[];for(let K=0;K<t;K++){let U=_e(n,S,t+K,i),w=new Uint16Array(ft);for(let y=0;y<t;y++){let p=xs(O.get(K,y));Wt(w,en(p,M[y]))}Wt(U,$t.decode(w)),H.push(U),Wt(P,en(B[K],M[K])),et(w)}O.clean();let v=_e(n,S,2*t,i);Wt(v,$t.decode(P));let N=l.decode(E);return Wt(N,v),et(B,M,P,v),x.encode([H,N])},decrypt:(g,E)=>{let[S,B]=x.decode(g),k=h.decode(E),M=new Uint16Array(ft);for(let O=0;O<t;O++)Wt(M,en(k[O],$t.encode(S[O])));return yc(B,$t.decode(M)),et(M,k,S),l.encode(B)}}};function wr(e){let t=xc(e),{HASH256:n,HASH512:r,KDF:o}=e,{secretCoder:s,lengths:i}=t,c=Ft("secretKey",i.secretKey,i.publicKey,32,32),f=32,l=64;return{info:{type:"ml-kem"},lengths:{...i,seed:64,msg:f,msgRand:f,secretKey:c.bytesLen},keygen:(a=wt(l))=>{D(a,l,"seed");let{publicKey:u,secretKey:d}=t.keygen(a.subarray(0,32)),h=n(u),x=c.encode([d,u,h,a.subarray(32)]);return et(d,h),{publicKey:u,secretKey:x}},getPublicKey:a=>{let[u,d,h,x]=c.decode(a);return Uint8Array.from(d)},encapsulate:(a,u=wt(f))=>{D(a,i.publicKey,"publicKey"),D(u,f,"message");let d=a.subarray(0,384*e.K),h=s.encode(s.decode(ps(d)));if(!Je(h,d))throw et(h),new Error("ML-KEM.encapsulate: wrong publicKey modulus");et(h);let x=r.create().update(u).update(n(a)).digest(),b=t.encrypt(a,u,x.subarray(32,64));return et(x.subarray(32)),{cipherText:b,sharedSecret:x.subarray(0,32)}},decapsulate:(a,u)=>{D(u,c.bytesLen,"secretKey"),D(a,i.cipherText,"cipherText");let d=c.bytesLen-96,h=d+32,x=n(u.subarray(d/2,h));if(!Je(x,u.subarray(h,h+32)))throw new Error("invalid secretKey: hash check failed");let[b,g,E,S]=c.decode(u),B=t.decrypt(a,b),k=r.create().update(B).update(E).digest(),M=k.subarray(0,32),O=t.encrypt(g,B,k.subarray(32,64)),P=Je(a,O),H=o.create({dkLen:32}).update(S).update(a).digest();return et(B,O,P?H:M),P?M:H}}}function bc(e,t,n){return bt.create({dkLen:e}).update(t).update(new Uint8Array([n])).digest()}var mr={HASH256:Xt,HASH512:fs,KDF:bt,XOF:gs,PRF:bc},Ba=wr({...mr,...br[512]}),Ie=wr({...mr,...br[768]}),bs=wr({...mr,...br[1024]});function wc(e,t=!1){let n=e.lengths,r=e.keygen;if(t){let s=e.Point.Fn;if(!s)throw new Error("No Point.Fn");r=(i=wt(n.seed))=>{D(i,n.seed,"seed");let c=s.isLE?Ht(i):Ct(i),f=s.toBytes(s.create(c));return{secretKey:f,publicKey:e.getPublicKey(f)}}}return{lengths:{secretKey:n.secretKey,publicKey:n.publicKey,seed:n.seed},keygen:r,getPublicKey:o=>e.getPublicKey(o)}}function Er(e,t=!1){let n=wc(e,t);if(!e.getSharedSecret)throw new Error("wrong curve");return{lengths:{...n.lengths,msg:n.lengths.seed,cipherText:n.lengths.publicKey},keygen:n.keygen,getPublicKey:n.getPublicKey,encapsulate(r,o=wt(e.lengths.seed)){let s=this.keygen(o).secretKey,i=this.decapsulate(r,s),c=e.getPublicKey(s);return et(s),{sharedSecret:i,cipherText:c}},decapsulate(r,o){let s=e.getSharedSecret(o,r);return e.lengths.publicKeyHasPrefix?s.subarray(1):s}}}function ke(e,t){return Ft(t,...e.map(n=>{if(typeof n.lengths[t]!="number")throw new Error("wrong length: "+t);return n.lengths[t]}))}function Br(e){return(t,n)=>e(t,{dkLen:n})}function mc(e,t,...n){let r=ke(n,"seed"),o=ke(n,"publicKey");e===void 0&&(e=r.bytesLen),X(e);function s(i){D(i,e);let c=r.decode(t(i,r.bytesLen)),f=n.map((u,d)=>u.keygen(c[d])),l=f.map(u=>u.secretKey),a=f.map(u=>u.publicKey);return{secretKey:l,publicKey:a}}return{info:{lengths:{seed:e,publicKey:o.bytesLen,secretKey:e}},getPublicKey(i){return this.keygen(i).publicKey},keygen(i=wt(e)){let{publicKey:c,secretKey:f}=s(i),l=o.encode(c);return et(c),et(f),{secretKey:i,publicKey:l}},expandDecapsulationKey:s,realSeedLen:e}}function nn(e,t,n,r,...o){let s=mc(e,n,...o),i=ke(o,"cipherText"),c=ke(o,"publicKey"),f=ke(o,"msg");return t===void 0&&(t=f.bytesLen),X(t),{lengths:{...s.info.lengths,msg:t,msgRand:f.bytesLen,cipherText:i.bytesLen},getPublicKey:s.getPublicKey,keygen:s.keygen,encapsulate(l,a=wt(f.bytesLen)){let u=c.decode(l),d=f.decode(a),h=o.map((E,S)=>E.encapsulate(u[S],d[S])),x=h.map(E=>E.sharedSecret),b=h.map(E=>E.cipherText),g={sharedSecret:r(u,b,x),cipherText:i.encode(b)};return et(x,b),g},decapsulate(l,a){let u=i.decode(l),{publicKey:d,secretKey:h}=s.expandDecapsulationKey(a),x=o.map((b,g)=>b.decapsulate(u[g],h[g]));return r(d,u,x)}}}function ws(e,t,n,r,o){return ut(r),ut(o),nn(32,32,Br(r),(s,i,c)=>o(Y(c[0],c[1],i[1],s[1],Nt(e))),t,n)}var Oa=ws("QSF-KEM(ML-KEM-768,P-256)-XOF(SHAKE256)-KDF(SHA3-256)",Ie,Er(_t,!0),bt,Xt),Ka=ws("QSF-KEM(ML-KEM-1024,P-384)-XOF(SHAKE256)-KDF(SHA3-256)",bs,Er(ts,!0),bt,Xt);function Ec(e,t,n,r,o){return ut(r),ut(o),nn(32,32,Br(r),(s,i,c)=>{let f=Y(c[0],c[1],i[0],s[0],i[1],s[1],Nt(e)),l=32,a=Y(Nt("hybrid_prk"),f),u=Bt(o,a),d=Y(se(l,2),Nt("shared_secret"),Nt("")),h=de(o,u,d,l);return et(u,d,a,f),h},t,n)}var ms=Er(ae),Ca=Ec("KitchenSink-KEM(ML-KEM-768,X25519)-XOF(SHAKE256)-KDF(HKDF-SHA-256)",Ie,ms,bt,$),Bc=nn(32,32,Br(bt),(e,t,n)=>Xt(Y(n[0],n[1],t[1],e[1],Nt("\\.//^\\"))),Ie,ms);function Ac(e,t,n,r){let o=e.Point.Fn;if(!o)throw new Error("no Point.Fn");function s(i){let c;for(let a=0,u=t;;a=u,u+=t){if(u>i.length)throw new Error("rejection sampling failed");if(c=o.fromBytes(i.subarray(a,u),!0),o.isValidNot0(c))break}let f=o.toBytes(o.create(c)),l=e.getPublicKey(f,!1);return{secretKey:f,publicKey:l}}return{lengths:{secretKey:t,publicKey:n,seed:r,msg:r,cipherText:n},keygen(i=wt(r)){return D(i,r,"seed"),s(i)},getPublicKey(i){return e.getPublicKey(i,!1)},encapsulate(i,c=wt(r)){D(c,r,"rand");let{secretKey:f}=s(c),l=this.decapsulate(i,f),a=e.getPublicKey(f,!1);return et(f),{sharedSecret:l,cipherText:a}},decapsulate(i,c){return e.getSharedSecret(c,i).subarray(1)}}}function Sc(e,t,n,r){let{secretKey:o,publicKeyUncompressed:s}=n.lengths;if(!o||!s)throw new Error("wrong curve");let i=Ac(n,o,s,r),c=64,f=c+r;return nn(32,32,l=>{D(l,32);let a=bt(l,{dkLen:f}),u=a.subarray(0,c),d=a.subarray(c,f);return Y(u,d)},(l,a,u)=>Xt(Y(u[0],u[1],a[1],l[1],Nt(e))),t,i)}var vc=Sc("MLKEM768-P256",Ie,_t,128);var rn=Bc,Es=vc;var Bs=!1,Lc=!1;async function As(e,t){if(Lc)return await t();try{return await e()}catch(n){if(n instanceof ReferenceError||n instanceof DOMException&&n.name==="NotSupportedError")return await t();throw n}}async function on(e,t){return await As(async()=>{let n=Ar(e)?e:await Tc(e),r=await crypto.subtle.importKey("raw",t,{name:"X25519"},Bs,[]);return new Uint8Array(await crypto.subtle.deriveBits({name:"X25519",public:r},n,256))},()=>{if(Ar(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return ae.scalarMult(e,t)})}async function Ue(e){return await As(async()=>on(e,ae.GuBytes),()=>{if(Ar(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return ae.scalarMultBase(e)})}var _c=new Uint8Array([48,46,2,1,0,48,5,6,3,43,101,110,4,34,4,32]);async function Tc(e){if(e.length!==32)throw new Error("X25519 private key must be 32 bytes");let t=new Uint8Array([..._c,...e]);return crypto.subtle.importKey("pkcs8",t,{name:"X25519"},Bs,["deriveBits"])}function Ar(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}var sn=class{s;transcript=[];buf=new Uint8Array(0);constructor(t){this.s=t.getReader()}async readLine(){let t=[];for(;;){let n=this.buf.indexOf(10);if(n>=0)return t.push(this.buf.subarray(0,n)),this.transcript.push(this.buf.subarray(0,n+1)),this.buf=this.buf.subarray(n+1),kc(Yt(t));this.buf.length>0&&(t.push(this.buf),this.transcript.push(this.buf));let r=await this.s.read();if(r.done)return this.buf=Yt(t),null;this.buf=r.value}}close(){return this.s.releaseLock(),{rest:this.buf,transcript:Yt(this.transcript)}}};function kc(e){return e.forEach(t=>{if(t<32||t>126)throw Error("invalid non-ASCII byte in header")}),new TextDecoder().decode(e)}function Yt(e){let t=e.reduce(((o,s)=>o+s.length),0),n=new Uint8Array(t),r=0;for(let o of e)n.set(o,r),r+=o.length;return n}function le(e,...t){return e.pipeThrough(new TransformStream({start(n){for(let r of t)n.enqueue(r)}}))}function cn(e){return new ReadableStream({start(t){t.enqueue(e),t.close()}})}async function Sr(e){if(!(e instanceof ReadableStream))throw new Error("readAll expects a ReadableStream<Uint8Array>");return new Uint8Array(await new Response(e).arrayBuffer())}async function Ss(e){if(!(e instanceof ReadableStream))throw new Error("readAllString expects a ReadableStream<Uint8Array>");return await new Response(e).text()}async function vs(e,t){let n=e.getReader(),r=[],o=0;for(;o<t;){let{done:f,value:l}=await n.read();if(f)throw Error("stream ended before reading "+t.toString()+" bytes");r.push(l),o+=l.length}n.releaseLock();let s=Yt(r),i=s.subarray(0,t),c=le(e,s.subarray(t));return{data:i,rest:c}}var dt=class{args;body;constructor(t,n){this.args=t,this.body=n}};async function Uc(e){let t=await e.readLine();if(t===null)throw Error("invalid stanza");let n=t.split(" ");if(n.length<2||n.shift()!=="->")return{next:t};for(let s of n)if(s.length===0)throw Error("invalid stanza");let r=[];for(;;){let s=await e.readLine();if(s===null)throw Error("invalid stanza");let i=tt.decode(s);if(i.length>48)throw Error("invalid stanza");if(r.push(i),i.length<48)break}let o=Yt(r);return{s:new dt(n,o)}}async function Ls(e){let t=new sn(e),n=await t.readLine();if(n!=="age-encryption.org/v1")throw Error("invalid version "+(n??"line"));let r=[];for(;;){let{s:o,next:s}=await Uc(t);if(o!==void 0){r.push(o);continue}if(!s.startsWith("--- "))throw Error("invalid header");let i=tt.decode(s.slice(4)),{rest:c,transcript:f}=t.close(),l=f.slice(0,f.length-1-s.length+3);return{stanzas:r,headerNoMAC:l,MAC:i,headerSize:f.length,rest:le(e,c)}}}function vr(e){let t=[];t.push(`age-encryption.org/v1
`);for(let n of e){t.push("-> "+n.args.join(" ")+`
`);for(let r=0;r<n.body.length;r+=48){let o=r+48;o>n.body.length&&(o=n.body.length),t.push(tt.encode(n.body.subarray(r,o))+`
`)}n.body.length%48===0&&t.push(`
`)}return t.push("---"),new TextEncoder().encode(t.join(""))}function _s(e,t){return Yt([vr(e),new TextEncoder().encode(" "+tt.encode(t)+`
`)])}function Ts(){return Tr()}function Tr(){let e=Q(32),t=rt.encodeFromBytes("AGE-SECRET-KEY-",e).toUpperCase();return Promise.resolve(t)}function Is(){let e=Q(32),t=rt.encodeFromBytes("AGE-SECRET-KEY-PQ-",e).toUpperCase();return Promise.resolve(t)}async function ks(e){let t;if(Rs(e))t=e;else if(e.startsWith("AGE-SECRET-KEY-PQ-1")){let r=rt.decodeToBytes(e);if(r.prefix.toUpperCase()!=="AGE-SECRET-KEY-PQ-"||r.bytes.length!==32)throw Error("invalid identity");let o=rn.getPublicKey(r.bytes);return rt.encode("age1pq",rt.toWords(o),!1)}else{let r=rt.decodeToBytes(e);if(!e.startsWith("AGE-SECRET-KEY-1")||r.prefix.toUpperCase()!=="AGE-SECRET-KEY-"||r.bytes.length!==32)throw Error("invalid identity");t=r.bytes}let n=await Ue(t);return rt.encodeFromBytes("age",n)}var an=class{recipient;constructor(t){let n=rt.decodeToBytes(t);if(!t.startsWith("age1pq1")||n.prefix.toLowerCase()!=="age1pq"||n.bytes.length!==1216)throw Error("invalid recipient");this.recipient=n.bytes}wrapFileKey(t){let{cipherText:n,sharedSecret:r}=rn.encapsulate(this.recipient),o=new TextEncoder().encode("age-encryption.org/mlkem768x25519"),{key:s,nonce:i}=gn(Us,r,o),c=ht(s,i).encrypt(t);return[new dt(["mlkem768x25519",tt.encode(n)],c)]}},ln=class{identity;constructor(t){let n=rt.decodeToBytes(t);if(!t.startsWith("AGE-SECRET-KEY-PQ-1")||n.prefix.toUpperCase()!=="AGE-SECRET-KEY-PQ-"||n.bytes.length!==32)throw Error("invalid identity");this.identity=n.bytes}unwrapFileKey(t){for(let n of t){if(n.args.length<1||n.args[0]!=="mlkem768x25519")continue;if(n.args.length!==2)throw Error("invalid mlkem768x25519 stanza");let r=tt.decode(n.args[1]);if(r.length!==1120||n.body.length!==32)throw Error("invalid mlkem768x25519 stanza");let o=rn.decapsulate(r,this.identity),s=new TextEncoder().encode("age-encryption.org/mlkem768x25519"),{key:i,nonce:c}=gn(Us,o,s);try{return ht(i,c).decrypt(n.body)}catch{continue}}return null}},Us=25722,Rc=80,Lr=16;function gn(e,t,n){let r=Oc(e),o=fn(r,void 0,"psk_id_hash",new Uint8Array(0)),s=fn(r,void 0,"info_hash",n),i=new Uint8Array(1+o.length+s.length);i[0]=0,i.set(o,1),i.set(s,1+o.length);let c=fn(r,t,"secret",new Uint8Array(0)),f=_r(r,c,"key",i,32),l=_r(r,c,"base_nonce",i,12);return{key:f,nonce:l}}function Oc(e){let t=new Uint8Array(10);return t.set(new TextEncoder().encode("HPKE"),0),t[4]=e>>8&255,t[5]=e&255,t[6]=0,t[7]=1,t[8]=0,t[9]=3,t}function fn(e,t,n,r){let o=new Uint8Array(7+e.length+n.length+r.length),s=0;return o.set(new TextEncoder().encode("HPKE-v1"),s),s+=7,o.set(e,s),s+=e.length,o.set(new TextEncoder().encode(n),s),s+=n.length,o.set(r,s),Bt($,o,t)}function _r(e,t,n,r,o){let s=new Uint8Array(9+e.length+n.length+r.length),i=0;return s[i]=o>>8&255,s[i+1]=o&255,i+=2,s.set(new TextEncoder().encode("HPKE-v1"),i),i+=7,s.set(e,i),i+=e.length,s.set(new TextEncoder().encode(n),i),i+=n.length,s.set(r,i),de($,t,s,o)}function Kc(e){e.length!==_t.lengths.publicKeyUncompressed&&(e=_t.Point.fromBytes(e).toBytes(!1));let t=_t.utils.randomSecretKey(),n=_t.getPublicKey(t,!1),r=_t.getSharedSecret(t,e,!0).subarray(1),o=new Uint8Array(n.length+e.length);o.set(n,0),o.set(e,n.length);let s=new Uint8Array(5);s.set(new TextEncoder().encode("KEM"),0),s[3]=Lr>>8,s[4]=Lr&255;let i=fn(s,void 0,"eae_prk",r),c=_r(s,i,"shared_secret",o,32);return{encapsulatedKey:n,sharedSecret:c}}var un=class{recipient;constructor(t){let n=rt.decodeToBytes(t);if(!t.startsWith("age1tag1")||n.prefix.toLowerCase()!=="age1tag"||n.bytes.length!==33)throw Error("invalid recipient");this.recipient=n.bytes}wrapFileKey(t){let{encapsulatedKey:n,sharedSecret:r}=Kc(this.recipient),o=new TextEncoder().encode("age-encryption.org/p256tag"),s=(()=>{let l=$(this.recipient).subarray(0,4),a=new Uint8Array(n.length+l.length);return a.set(n,0),a.set(l,n.length),Bt($,a,o).subarray(0,4)})(),{key:i,nonce:c}=gn(Lr,r,o),f=ht(i,c).encrypt(t);return[new dt(["p256tag",tt.encode(s),tt.encode(n)],f)]}},dn=class{recipient;constructor(t){let n=rt.decodeToBytes(t);if(!t.startsWith("age1tagpq1")||n.prefix.toLowerCase()!=="age1tagpq"||n.bytes.length!==1249)throw Error("invalid recipient");this.recipient=n.bytes}wrapFileKey(t){let{cipherText:n,sharedSecret:r}=Es.encapsulate(this.recipient),o=new TextEncoder().encode("age-encryption.org/mlkem768p256tag"),s=(()=>{let l=$(this.recipient.subarray(1184)).subarray(0,4),a=new Uint8Array(n.length+l.length);return a.set(n,0),a.set(l,n.length),Bt($,a,o).subarray(0,4)})(),{key:i,nonce:c}=gn(Rc,r,o),f=ht(i,c).encrypt(t);return[new dt(["mlkem768p256tag",tt.encode(s),tt.encode(n)],f)]}},hn=class{recipient;constructor(t){let n=rt.decodeToBytes(t);if(!t.startsWith("age1")||n.prefix.toLowerCase()!=="age"||n.bytes.length!==32)throw Error("invalid recipient");this.recipient=n.bytes}async wrapFileKey(t){let n=Q(32),r=await Ue(n),o=await on(n,this.recipient),s=new Uint8Array(r.length+this.recipient.length);s.set(r),s.set(this.recipient,r.length);let i=new TextEncoder().encode("age-encryption.org/v1/X25519"),c=Ut($,o,s,i,32);return[new dt(["X25519",tt.encode(r)],xn(t,c))]}},Re=class{identity;recipient;constructor(t){if(Rs(t)){this.identity=t,this.recipient=Ue(t);return}let n=rt.decodeToBytes(t);if(!t.startsWith("AGE-SECRET-KEY-1")||n.prefix.toUpperCase()!=="AGE-SECRET-KEY-"||n.bytes.length!==32)throw Error("invalid identity");this.identity=n.bytes,this.recipient=Ue(n.bytes)}async unwrapFileKey(t){for(let n of t){if(n.args.length<1||n.args[0]!=="X25519")continue;if(n.args.length!==2)throw Error("invalid X25519 stanza");let r=tt.decode(n.args[1]);if(r.length!==32)throw Error("invalid X25519 stanza");let o=await on(this.identity,r),s=await this.recipient,i=new Uint8Array(r.length+s.length);i.set(r),i.set(s,r.length);let c=new TextEncoder().encode("age-encryption.org/v1/X25519"),f=Ut($,o,i,c,32),l=bn(n.body,f);if(l!==null)return l}return null}},pn=class{passphrase;logN;constructor(t,n){this.passphrase=t,this.logN=n}wrapFileKey(t){let n=Q(16),r="age-encryption.org/v1/scrypt",o=new Uint8Array(r.length+16);o.set(new TextEncoder().encode(r)),o.set(n,r.length);let s=Zn(this.passphrase,o,{N:2**this.logN,r:8,p:1,dkLen:32});return[new dt(["scrypt",tt.encode(n),this.logN.toString()],xn(t,s))]}},yn=class{passphrase;constructor(t){this.passphrase=t}unwrapFileKey(t){for(let n of t){if(n.args.length<1||n.args[0]!=="scrypt")continue;if(t.length!==1)throw Error("scrypt recipient is not the only one in the header");if(n.args.length!==3||!/^[1-9][0-9]*$/.test(n.args[2]))throw Error("invalid scrypt stanza");let r=tt.decode(n.args[1]);if(r.length!==16)throw Error("invalid scrypt stanza");let o=Number(n.args[2]);if(o>20)throw Error("scrypt work factor is too high");let s="age-encryption.org/v1/scrypt",i=new Uint8Array(s.length+16);i.set(new TextEncoder().encode(s)),i.set(r,s.length);let c=Zn(this.passphrase,i,{N:2**o,r:8,p:1,dkLen:32}),f=bn(n.body,c);if(f!==null)return f}return null}};function xn(e,t){let n=new Uint8Array(12);return ht(t,n).encrypt(e)}function bn(e,t){if(e.length!==32)throw Error("invalid stanza");let n=new Uint8Array(12);try{return ht(t,n).decrypt(e)}catch{return null}}function Rs(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}var Qt=16,kr=64*1024,Ir=kr+Qt;function Os(e){let t=new Uint8Array(12),n=()=>{for(let i=t.length-2;i>=0&&(t[i]++,t[i]===0);i--);},r=!0,o=new Uint8Array(Ir),s=0;return new TransformStream({transform(i,c){for(;i.length>0;){if(s===o.length){let l=ht(e,t).decrypt(o);c.enqueue(l),n(),s=0,r=!1}let f=Math.min(o.length-s,i.length);o.set(i.subarray(0,f),s),s+=f,i=i.subarray(f)}},flush(i){t[11]=1;let c=ht(e,t).decrypt(o.subarray(0,s));if(!r&&c.length===0)throw new Error("final chunk is empty");i.enqueue(c)}})}function Ks(e){if(e<Qt)throw Error("ciphertext is too small");if(e===Qt)return 0;let t=Math.floor(e/Ir),n=e%Ir;if(0<n&&n<=Qt)throw Error("ciphertext size is invalid");let r=e;return r-=t*Qt,r-=n>0?Qt:0,r}function Cs(e){let t=new Uint8Array(12),n=()=>{for(let s=t.length-2;s>=0&&(t[s]++,t[s]===0);s--);},r=new Uint8Array(kr),o=0;return new TransformStream({transform(s,i){for(;s.length>0;){if(o===r.length){let f=ht(e,t).encrypt(r);i.enqueue(f),n(),o=0}let c=Math.min(r.length-o,s.length);r.set(s.subarray(0,c),o),o+=c,s=s.subarray(c)}},flush(s){t[11]=1;let i=ht(e,t).encrypt(r.subarray(0,o));s.enqueue(i)}})}function Hs(e){let t=Math.max(1,Math.ceil(e/kr));return e+Qt*t}var Ur={};An(Ur,{decode:()=>Hc,encode:()=>Cc});function Cc(e){let t=[];t.push(`-----BEGIN AGE ENCRYPTED FILE-----
`);for(let n=0;n<e.length;n+=48){let r=n+48;r>e.length&&(r=e.length),t.push(qn.encode(e.subarray(n,r))+`
`)}return t.push(`-----END AGE ENCRYPTED FILE-----
`),t.join("")}function Hc(e){let t=e.trim().replaceAll(`\r
`,`
`).split(`
`);if(t.shift()!=="-----BEGIN AGE ENCRYPTED FILE-----")throw Error("invalid header");if(t.pop()!=="-----END AGE ENCRYPTED FILE-----")throw Error("invalid footer");function n(r,o){return r===t.length-1?o.length>0&&o.length<=64&&o.length%4===0:o.length===64}if(!t.every((r,o)=>n(o,r)))throw Error("invalid line length");if(!t.every(r=>/^[A-Za-z0-9+/=]+$/.test(r)))throw Error("invalid base64");return qn.decode(t.join(""))}var Hr={};An(Hr,{WebAuthnIdentity:()=>Cr,WebAuthnRecipient:()=>Kr,createCredential:()=>Dc});function wn(e){if(e.length===0)throw Error("cbor: unexpected EOF");let t=e[0]>>5,n=e[0]&31;if(n<=23)return[t,n,e.subarray(1)];if(n===24){if(e.length<2)throw Error("cbor: unexpected EOF");return[t,e[1],e.subarray(2)]}if(n===25){if(e.length<3)throw Error("cbor: unexpected EOF");return[t,e[1]<<8|e[2],e.subarray(3)]}throw Error("cbor: unsupported argument encoding")}function Ns(e){let[t,n,r]=wn(e);if(t!==0)throw Error("cbor: expected unsigned integer");return[n,r]}function Ms(e){let[t,n,r]=wn(e);if(t!==2)throw Error("cbor: expected byte string");if(n>r.length)throw Error("cbor: unexpected EOF");return[r.subarray(0,n),r.subarray(n)]}function Rr(e){let[t,n,r]=wn(e);if(t!==3)throw Error("cbor: expected text string");if(n>r.length)throw Error("cbor: unexpected EOF");return[new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0}).decode(r.subarray(0,n)),r.subarray(n)]}function Ds(e){let[t,n,r]=wn(e);if(t!==4)throw Error("cbor: expected array");let o=r,s=[];for(let i=0;i<n;i++){let c;[c,o]=Rr(o),s.push(c)}return[s,o]}function Ps(e){if(e<=23)return new Uint8Array([e]);if(e<=255)return new Uint8Array([24,e]);if(e<=65535)return new Uint8Array([25,e>>8,e&255]);throw Error("cbor: unsigned integer too large")}function qs(e){if(e.length<=23)return new Uint8Array([64|e.length,...e]);if(e.length<=255)return new Uint8Array([88,e.length,...e]);if(e.length<=65535)return new Uint8Array([89,e.length>>8,e.length&255,...e]);throw Error("cbor: byte string too long")}function Or(e){let t=new TextEncoder().encode(e);if(t.length<=23)return new Uint8Array([96|t.length,...t]);if(t.length<=255)return new Uint8Array([120,t.length,...t]);if(t.length<=65535)return new Uint8Array([121,t.length>>8,t.length&255,...t]);throw Error("cbor: text string too long")}function Vs(e){let t=e.flatMap(n=>[...Or(n)]);if(e.length<=23)return new Uint8Array([128|e.length,...t]);if(e.length<=255)return new Uint8Array([152,e.length,...t]);if(e.length<=65535)return new Uint8Array([153,e.length>>8,e.length&255,...t]);throw Error("cbor: array too long")}var Mc=[{type:"public-key",alg:-8},{type:"public-key",alg:-7},{type:"public-key",alg:-257}];async function Dc(e){let t=await navigator.credentials.create({publicKey:{rp:{name:"",id:e.rpId},user:{name:e.keyName,id:Q(8),displayName:""},pubKeyCredParams:Mc,authenticatorSelection:{requireResidentKey:e.type!=="security-key",residentKey:e.type!=="security-key"?"required":"discouraged",userVerification:"required"},hints:e.type==="security-key"?["security-key"]:[],extensions:{prf:{}},challenge:new Uint8Array([0]).buffer}});if(!t.getClientExtensionResults().prf?.enabled)throw Error("PRF extension not available (need macOS 15+, Chrome 132+)");let n=e.rpId??new URL(window.origin).hostname;return Pc(t,n)}var js="AGE-PLUGIN-FIDO2PRF-";function Pc(e,t){let n=e.response,r=Ps(1),o=qs(new Uint8Array(e.rawId)),s=Or(t),i=Vs(n.getTransports()),c=new Uint8Array([...r,...o,...s,...i]);return rt.encode(js,rt.toWords(c),!1).toUpperCase()}function qc(e){let t=rt.decodeToBytes(e);if(!e.startsWith(js+"1"))throw Error("invalid identity");let[n,r]=Ns(t.bytes);if(n!==1)throw Error("unsupported identity version");let[o,s]=Ms(r),[i,c]=Rr(s),[f]=Ds(c);return[o,i,f]}var En="age-encryption.org/fido2prf",mn=class{credId;transports;rpId;constructor(t){if(t?.identity){let[n,r,o]=qc(t.identity);this.credId=n,this.transports=o,this.rpId=r}else this.rpId=t?.rpId}async getCredential(t){let r=(await navigator.credentials.get({publicKey:{allowCredentials:this.credId?[{id:this.credId,transports:this.transports,type:"public-key"}]:[],challenge:Q(16),extensions:{prf:{eval:Vc(t)}},userVerification:"required",rpId:this.rpId}})).getClientExtensionResults().prf?.results;if(r===void 0)throw Error("PRF extension not available (need macOS 15+, Chrome 132+)");return r}},Kr=class extends mn{async wrapFileKey(t){let n=Q(16),r=await this.getCredential(n),o=Zs(r);return[new dt([En,tt.encode(n)],xn(t,o))]}},Cr=class extends mn{async unwrapFileKey(t){for(let n of t){if(n.args.length<1||n.args[0]!==En)continue;if(n.args.length!==2)throw Error("invalid prf stanza");let r=tt.decode(n.args[1]);if(r.length!==16)throw Error("invalid prf stanza");let o=await this.getCredential(r),s=Zs(o),i=bn(n.body,s);if(i!==null)return i}return null}};function Vc(e){let t=new TextEncoder().encode(En),n=new Uint8Array(t.length+e.length+1);n.set(t,0),n[t.length]=1,n.set(e,t.length+1);let r=new Uint8Array(t.length+e.length+1);return r.set(t,0),r[t.length]=2,r.set(e,t.length+1),{first:n,second:r}}function Zs(e){if(e.second===void 0)throw Error("Missing second PRF result");let t=new Uint8Array(e.first.byteLength+e.second.byteLength);return t.set(new Uint8Array(e.first),0),t.set(new Uint8Array(e.second),e.first.byteLength),Bt($,t,new TextEncoder().encode(En))}var Nr=class{passphrase=null;scryptWorkFactor=18;recipients=[];setPassphrase(t){if(this.passphrase!==null)throw new Error("can encrypt to at most one passphrase");if(this.recipients.length!==0)throw new Error("can't encrypt to both recipients and passphrases");this.passphrase=t}setScryptWorkFactor(t){this.scryptWorkFactor=t}addRecipient(t){if(this.passphrase!==null)throw new Error("can't encrypt to both recipients and passphrases");if(typeof t=="string")if(t.startsWith("age1pq1"))this.recipients.push(new an(t));else if(t.startsWith("age1tag1"))this.recipients.push(new un(t));else if(t.startsWith("age1tagpq1"))this.recipients.push(new dn(t));else if(t.startsWith("age1"))this.recipients.push(new hn(t));else throw new Error("unrecognized recipient type");else this.recipients.push(t)}async encrypt(t){let n=Q(16),r=[],o=this.recipients;this.passphrase!==null&&(o=[new pn(this.passphrase,this.scryptWorkFactor)]);for(let h of o)r.push(...await h.wrapFileKey(n));let s=new TextEncoder().encode("header"),i=Ut($,n,void 0,s,32),c=gt($,i,vr(r)),f=_s(r,c),l=Q(16),a=new TextEncoder().encode("payload"),u=Ut($,n,l,a,32),d=Cs(u);return t instanceof ReadableStream?Object.assign(le(t.pipeThrough(d),f,l),{size:h=>Hs(h)+f.length+l.length}):(typeof t=="string"&&(t=new TextEncoder().encode(t)),await Sr(le(cn(t).pipeThrough(d),f,l)))}},Mr=class{identities=[];addPassphrase(t){this.identities.push(new yn(t))}addIdentity(t){if(Zc(t))this.identities.push(new Re(t));else if(typeof t=="string")if(t.startsWith("AGE-SECRET-KEY-1"))this.identities.push(new Re(t));else if(t.startsWith("AGE-SECRET-KEY-PQ-1"))this.identities.push(new ln(t));else throw new Error("unrecognized identity type");else this.identities.push(t)}async decrypt(t,n){let r=t instanceof ReadableStream?t:cn(t),{fileKey:o,headerSize:s,rest:i}=await this.decryptHeaderInternal(r),{data:c,rest:f}=await vs(i,16),l=new TextEncoder().encode("payload"),a=Ut($,o,c,l,32),u=Os(a),d=f.pipeThrough(u),h=Object.assign(d,{size:x=>Ks(x-s-c.length)});return t instanceof ReadableStream?h:n==="text"?await Ss(d):await Sr(d)}async decryptHeader(t){return(await this.decryptHeaderInternal(cn(t))).fileKey}async decryptHeaderInternal(t){let n=await Ls(t),r=await this.unwrapFileKey(n.stanzas);if(r===null)throw Error("no identity matched any of the file's recipients");let o=new TextEncoder().encode("header"),s=Ut($,r,void 0,o,32),i=gt($,s,n.headerNoMAC);if(!jc(n.MAC,i))throw Error("invalid header HMAC");return{fileKey:r,headerSize:n.headerSize,rest:n.rest}}async unwrapFileKey(t){for(let n of this.identities){let r=await n.unwrapFileKey(t);if(r!==null)return r}return null}};function jc(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function Zc(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}return $s(Gc);})();
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@scure/base/index.js:
  (*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ciphers/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/curves/utils.js:
@noble/curves/abstract/modular.js:
@noble/curves/abstract/curve.js:
@noble/curves/abstract/montgomery.js:
@noble/curves/abstract/weierstrass.js:
@noble/curves/ed25519.js:
@noble/curves/nist.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/post-quantum/utils.js:
@noble/post-quantum/_crystals.js:
@noble/post-quantum/ml-kem.js:
@noble/post-quantum/hybrid.js:
  (*! noble-post-quantum - MIT License (c) 2024 Paul Miller (paulmillr.com) *)
*/
